

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="253746">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>File Based System Access Control &#8212; Starburst Enterprise Presto</title>
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/presto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LDAP group provider" href="ldap-group-provider.html" />
    <link rel="prev" title="Built-in System Access Control" href="built-in-system-access-control.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#security/file-system-access-control" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise Presto"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise Presto logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise Presto</span>
          <span class="md-header-nav__topic"> File Based System Access Control </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (338-e)" href="/338-e/">Latest LTS (338-e)</a>
      
          <a title="332-e LTS" href="/332-e/">332-e LTS</a>
      
          <a title="323-e LTS" href="/323-e/">323-e LTS</a>
      
          <a title="Latest STS (341-e)" href="/341-e/">Latest STS (341-e)</a>
      
          <a title="340-e STS" href="/340-e/">340-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../security.html" class="md-tabs__link">Security</a></li>
          <li class="md-tabs__item"><a href="built-in-system-access-control.html" class="md-tabs__link">Built-in System Access Control</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise Presto" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise Presto">Starburst Enterprise Presto</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../kubernetes.html" class="md-nav__link">Kubernetes operator</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="server.html" class="md-nav__link">Kerberos authentication for coordinator</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cli.html" class="md-nav__link">Kerberos authentication with CLI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap.html" class="md-nav__link">LDAP authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-file.html" class="md-nav__link">Password file authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="salesforce.html" class="md-nav__link">Salesforce authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-mapping.html" class="md-nav__link">User mapping</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tls.html" class="md-nav__link">Java keystores and truststores</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="built-in-system-access-control.html" class="md-nav__link">Built-in system access control</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> File Based </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">File Based</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-file-system-access-control--page-root" class="md-nav__link">File Based System Access Control</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#refresh" class="md-nav__link">Refresh</a>
        </li>
        <li class="md-nav__item"><a href="#catalog-rules" class="md-nav__link">Catalog Rules</a>
        </li>
        <li class="md-nav__item"><a href="#schema-rules" class="md-nav__link">Schema Rules</a>
        </li>
        <li class="md-nav__item"><a href="#table-rules" class="md-nav__link">Table Rules</a>
        </li>
        <li class="md-nav__item"><a href="#query-rules" class="md-nav__link">Query Rules</a>
        </li>
        <li class="md-nav__item"><a href="#impersonation-rules" class="md-nav__link">Impersonation Rules</a>
        </li>
        <li class="md-nav__item"><a href="#principal-rules" class="md-nav__link">Principal Rules</a>
        </li>
        <li class="md-nav__item"><a href="#system-information-rules" class="md-nav__link">System Information Rules</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap-group-provider.html" class="md-nav__link">LDAP group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="secrets.html" class="md-nav__link">Secrets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internal-communication.html" class="md-nav__link">Secure internal communication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="audit.html" class="md-nav__link">Query audit</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="event-logger.html" class="md-nav__link">Event logger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="rbac.html" class="md-nav__link">Role based access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="system-ranger.html" class="md-nav__link">System level security with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-ranger.html" class="md-nav__link">Hive level security with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-sentry.html" class="md-nav__link">Hive level security with Apache Sentry</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="impersonation.html" class="md-nav__link">User impersonation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="credential-passthrough.html" class="md-nav__link">Kerberos credential passthrough</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="okta-authentication.html" class="md-nav__link">Okta authentication</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">-</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">342-e STS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-file-system-access-control--page-root" class="md-nav__link">File Based System Access Control</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#refresh" class="md-nav__link">Refresh</a>
        </li>
        <li class="md-nav__item"><a href="#catalog-rules" class="md-nav__link">Catalog Rules</a>
        </li>
        <li class="md-nav__item"><a href="#schema-rules" class="md-nav__link">Schema Rules</a>
        </li>
        <li class="md-nav__item"><a href="#table-rules" class="md-nav__link">Table Rules</a>
        </li>
        <li class="md-nav__item"><a href="#query-rules" class="md-nav__link">Query Rules</a>
        </li>
        <li class="md-nav__item"><a href="#impersonation-rules" class="md-nav__link">Impersonation Rules</a>
        </li>
        <li class="md-nav__item"><a href="#principal-rules" class="md-nav__link">Principal Rules</a>
        </li>
        <li class="md-nav__item"><a href="#system-information-rules" class="md-nav__link">System Information Rules</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="security-file-system-access-control--page-root">File Based System Access Control<a class="headerlink" href="#security-file-system-access-control--page-root" title="Permalink to this headline">#</a></h1>
<p>This access control plugin allows you to specify authorization rules in a JSON file.</p>

<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">#</a></h2>
<p>To use this plugin, add an <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code> file containing two
required properties: <code class="docutils literal notranslate"><span class="pre">access-control.name</span></code>, which must be equal to <code class="docutils literal notranslate"><span class="pre">file</span></code>, and
<code class="docutils literal notranslate"><span class="pre">security.config-file</span></code>, which must be equal to the location of the config file.
For example, if a config file named <code class="docutils literal notranslate"><span class="pre">rules.json</span></code>
resides in <code class="docutils literal notranslate"><span class="pre">etc</span></code>, add an <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code> with the following
contents:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>access-control.name=file
security.config-file=etc/rules.json
</pre></div>
</div>
<p>The config file is specified in JSON format. It contains rules that define
which users have access to which resources. The rules are read from top to bottom
and the first matching rule is applied. If no rule matches, access is denied.</p>


<h2 id="refresh">Refresh<a class="headerlink" href="#refresh" title="Permalink to this headline">#</a></h2>
<p>By default, when a change is made to the JSON rules file, Presto must be restarted
to load the changes. There is an optional property to refresh the properties without requiring a
Presto restart. The refresh period is specified in the <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>security.refresh-period=1s
</pre></div>
</div>


<h2 id="catalog-rules">Catalog Rules<a class="headerlink" href="#catalog-rules" title="Permalink to this headline">#</a></h2>
<p>These rules govern the catalogs particular users can access. The user is
granted access to a catalog, based on the first matching rule read from top to
bottom. If no rule matches, access is denied. Each rule is composed of the
following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against user name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regex to match against catalog name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): string indicating whether a user has access to the catalog.
This value can be <code class="docutils literal notranslate"><span class="pre">all</span></code>, <code class="docutils literal notranslate"><span class="pre">read-only</span></code> or <code class="docutils literal notranslate"><span class="pre">none</span></code>, and defaults to <code class="docutils literal notranslate"><span class="pre">none</span></code>.
Setting this value to <code class="docutils literal notranslate"><span class="pre">read-only</span></code> has the same behavior as the <code class="docutils literal notranslate"><span class="pre">read-only</span></code>
system access control plugin.</p></li>
</ul>
<p>In order for a rule to apply the user name must match the regular expression
specified in <code class="docutils literal notranslate"><span class="pre">user</span></code> attribute.</p>
<p>For group names, a rule can be applied if at least one group name of this user
matches the <code class="docutils literal notranslate"><span class="pre">group</span></code> regular expression.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, all users have access to the <code class="docutils literal notranslate"><span class="pre">system</span></code> catalog. You can
override this behavior by adding a rule.</p>
<p>Boolean <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span></code> are also supported as legacy values for <code class="docutils literal notranslate"><span class="pre">allow</span></code>,
to support backwards compatibility.  <code class="docutils literal notranslate"><span class="pre">true</span></code> maps to <code class="docutils literal notranslate"><span class="pre">all</span></code>, and <code class="docutils literal notranslate"><span class="pre">false</span></code> maps to <code class="docutils literal notranslate"><span class="pre">none</span></code>.</p>
</div>
<p>For example, if you want to allow only the user <code class="docutils literal notranslate"><span class="pre">admin</span></code> to access the
<code class="docutils literal notranslate"><span class="pre">mysql</span></code> and the <code class="docutils literal notranslate"><span class="pre">system</span></code> catalog, allow users from the <code class="docutils literal notranslate"><span class="pre">finance</span></code>
and <code class="docutils literal notranslate"><span class="pre">admin</span></code> groups access to <code class="docutils literal notranslate"><span class="pre">postgres</span></code> catalog, allow all users to
access the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog, and deny all other access, you can use the
following rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"admin"</span><span class="p">,</span>
      <span class="nt">"catalog"</span><span class="p">:</span> <span class="s2">"(mysql|system)"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="s2">"all"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"group"</span><span class="p">:</span> <span class="s2">"finance|human_resources"</span><span class="p">,</span>
      <span class="nt">"catalog"</span><span class="p">:</span> <span class="s2">"postgres"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"catalog"</span><span class="p">:</span> <span class="s2">"hive"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="s2">"all"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"alice"</span><span class="p">,</span>
      <span class="nt">"catalog"</span><span class="p">:</span> <span class="s2">"postgresql"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="s2">"read-only"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"catalog"</span><span class="p">:</span> <span class="s2">"system"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="s2">"none"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For group-based rules to match, users need to be assigned to groups by a
<a class="reference internal" href="../develop/group-provider.html"><span class="doc">Group provider</span></a>.</p>


<h2 id="schema-rules">Schema Rules<a class="headerlink" href="#schema-rules" title="Permalink to this headline">#</a></h2>
<p>These rules allow you to grant ownership of a schema. Having ownership of an
schema allows users to execute <code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">SCHEMA</span></code>, <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">SCHEMA</span></code> (both renaming
and setting authorization) and <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">SCHEMA</span></code>. The user is granted
ownership of a schema, based on the first matching rule read from top to
bottom. If no rule matches, ownership is not granted. Each rule is composed of
the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against user name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regex to match against schema name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">owner</span></code> (required): boolean indicating whether the user is to be considered
an owner of the schema. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
<p>For example, to provide ownership of all schemas to user <code class="docutils literal notranslate"><span class="pre">admin</span></code>, treat all
users as owners of <code class="docutils literal notranslate"><span class="pre">default</span></code> schema and prevent user <code class="docutils literal notranslate"><span class="pre">guest</span></code> from ownership
of any schema, you can use the following rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"schemas"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"admin"</span><span class="p">,</span>
      <span class="nt">"schema"</span><span class="p">:</span> <span class="s2">".*"</span><span class="p">,</span>
      <span class="nt">"owner"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"guest"</span><span class="p">,</span>
      <span class="nt">"owner"</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"schema"</span><span class="p">:</span> <span class="s2">"default"</span><span class="p">,</span>
      <span class="nt">"owner"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>


<h2 id="table-rules">Table Rules<a class="headerlink" href="#table-rules" title="Permalink to this headline">#</a></h2>
<p>These rules define the privileges for table access for users. If no table rules
are specified, all users are treated as having all privileges by default. The
user is granted privileges based on the first matching rule read from top to
bottom. Each rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against user name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regex to match against schema name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table</span></code> (optional): regex to match against table names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privileges</span></code> (required): zero or more of <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>,
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, <code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code>, <code class="docutils literal notranslate"><span class="pre">GRANT_SELECT</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These rules do not apply to <code class="docutils literal notranslate"><span class="pre">information_schema</span></code>.</p>
</div>
<p>The example below defines the following table access policy:</p>
<ul class="simple">
<li><p>User <code class="docutils literal notranslate"><span class="pre">admin</span></code> has all privileges across all tables and schemas</p></li>
<li><p>User <code class="docutils literal notranslate"><span class="pre">banned_user</span></code> has no privileges</p></li>
<li><p>All users have <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> privileges on all tables in <code class="docutils literal notranslate"><span class="pre">default</span></code> schema</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"tables"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"admin"</span><span class="p">,</span>
      <span class="nt">"privileges"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"SELECT"</span><span class="p">,</span> <span class="s2">"INSERT"</span><span class="p">,</span> <span class="s2">"DELETE"</span><span class="p">,</span> <span class="s2">"OWNERSHIP"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"banned_user"</span><span class="p">,</span>
      <span class="nt">"privileges"</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"schema"</span><span class="p">:</span> <span class="s2">"default"</span><span class="p">,</span>
      <span class="nt">"table"</span><span class="p">:</span> <span class="s2">".*"</span><span class="p">,</span>
      <span class="nt">"privileges"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"SELECT"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>


<span id="id1"></span><h2 id="query-rules">Query Rules<a class="headerlink" href="#query-rules" title="Permalink to this headline">#</a></h2>
<p>These rules control the ability of a user to execute, view, or kill a query. The user is
granted or denied access, based on the first matching rule read from top to bottom. If no
rules are specified, all users are allowed to execute queries, and to view or kill queries
owned by any user. If no rule matches, query management is denied. Each rule is composed
of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against user name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">owner</span></code> (optional): regex to match against the query owner name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): set of query permissions granted to user. Values: <code class="docutils literal notranslate"><span class="pre">execute</span></code>, <code class="docutils literal notranslate"><span class="pre">view</span></code>, <code class="docutils literal notranslate"><span class="pre">kill</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users always have permission to view or kill their own queries.</p>
</div>
<p>For example, if you want to allow the user <code class="docutils literal notranslate"><span class="pre">admin</span></code> full query access, allow the user <code class="docutils literal notranslate"><span class="pre">alice</span></code>
to execute and kill queries, any user to execute queries, and deny all other access, you can use
the following rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"queries"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"admin"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"execute"</span><span class="p">,</span> <span class="s2">"kill"</span><span class="p">,</span> <span class="s2">"view"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"alice"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"execute"</span><span class="p">,</span> <span class="s2">"kill"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"execute"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>


<span id="id2"></span><h2 id="impersonation-rules">Impersonation Rules<a class="headerlink" href="#impersonation-rules" title="Permalink to this headline">#</a></h2>
<p>These rules control the ability of a user to impersonate another user.  In
some environments it is desirable for an administrator (or managed system) to
run queries on behalf of other users.  In these cases, the administrator
authenticates using their credentials, and then submits a query as a different
user.  When the user context is changed, Presto will verify the administrator
is authorized to run queries as the target user.</p>
<p>When these rules are present, the authorization is based on the first matching rule,
processed from top to bottom. If no rules match, the authorization is denied.
If impersonation rules are not present but the legacy principal rules are specified,
it is assumed impersonation access control is being handled by the principal rules,
so impersonation is allowed.  If neither impersonation nor principal rules are
defined, impersonation is not allowed.</p>
<p>Each impersonation rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">originalUser</span></code> (required): regex to match against the user requesting the impersonation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">newUser</span></code> (required): regex to match against the user that will be impersonated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (optional): boolean indicating if the authentication should be allowed.</p></li>
</ul>
<p>The following example allows the two admins, <code class="docutils literal notranslate"><span class="pre">alice</span></code> and <code class="docutils literal notranslate"><span class="pre">bob</span></code>, to impersonate
any user, except they may not impersonate each other.  It also allows any user to
impersonate the <code class="docutils literal notranslate"><span class="pre">test</span></code> user:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">"impersonation"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">"originalUser"</span><span class="p">:</span> <span class="s2">"alice"</span><span class="p">,</span>
            <span class="nt">"newUser"</span><span class="p">:</span> <span class="s2">"bob"</span><span class="p">,</span>
            <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">"originalUser"</span><span class="p">:</span> <span class="s2">"bob"</span><span class="p">,</span>
            <span class="nt">"newUser"</span><span class="p">:</span> <span class="s2">"alice"</span><span class="p">,</span>
            <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">"originalUser"</span><span class="p">:</span> <span class="s2">"alice|bob"</span><span class="p">,</span>
            <span class="nt">"newUser"</span><span class="p">:</span> <span class="s2">".*"</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">"originalUser"</span><span class="p">:</span> <span class="s2">".*"</span><span class="p">,</span>
            <span class="nt">"newUser"</span><span class="p">:</span> <span class="s2">"test"</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>


<span id="id3"></span><h2 id="principal-rules">Principal Rules<a class="headerlink" href="#principal-rules" title="Permalink to this headline">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Principal rules are deprecated and will be removed in a future release.
These rules have been replaced with <a class="reference internal" href="user-mapping.html"><span class="doc">User Mapping</span></a>, which
specifies how a complex authentication user name is mapped to a simple
user name for Presto, and impersonation rules defined above.</p>
</div>
<p>These rules serve to enforce a specific matching between a principal and a
specified user name. The principal is granted authorization as a user, based
on the first matching rule read from top to bottom. If no rules are specified,
no checks are performed. If no rule matches, user authorization is denied.
Each rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">principal</span></code> (required): regex to match and group against principal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against user name. If matched, it
will grant or deny the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">principal_to_user</span></code> (optional): replacement string to substitute against
principal. If the result of the substitution is same as the user name, it will
grant or deny the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): boolean indicating whether a principal can be authorized
as a user.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You would at least specify one criterion in a principal rule. If you specify
both criteria in a principal rule, it returns the desired conclusion when
either of criteria is satisfied.</p>
</div>
<p>The following implements an exact matching of the full principal name for LDAP
and Kerberos authentication:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"principals"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"principal"</span><span class="p">:</span> <span class="s2">"(.*)"</span><span class="p">,</span>
      <span class="nt">"principal_to_user"</span><span class="p">:</span> <span class="s2">"$1"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"principal"</span><span class="p">:</span> <span class="s2">"([^/]+)(/.*)?@.*"</span><span class="p">,</span>
      <span class="nt">"principal_to_user"</span><span class="p">:</span> <span class="s2">"$1"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you want to allow users to use the exact same name as their Kerberos principal
name, and allow <code class="docutils literal notranslate"><span class="pre">alice</span></code> and <code class="docutils literal notranslate"><span class="pre">bob</span></code> to use a group principal named as
<code class="docutils literal notranslate"><span class="pre">group@example.net</span></code>, you can use the following rules.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"principals"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"principal"</span><span class="p">:</span> <span class="s2">"([^/]+)/?.*@example.net"</span><span class="p">,</span>
      <span class="nt">"principal_to_user"</span><span class="p">:</span> <span class="s2">"$1"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"principal"</span><span class="p">:</span> <span class="s2">"group@example.net"</span><span class="p">,</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"alice|bob"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>


<span id="id4"></span><h2 id="system-information-rules">System Information Rules<a class="headerlink" href="#system-information-rules" title="Permalink to this headline">#</a></h2>
<p>These rules specify which users can access the system information management interface.
The user is granted or denied access, based on the first matching rule read from top to
bottom. If no rules are specified, all access to system information is denied. If
no rule matches, system access is denied. Each rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against user name. If matched, it
will grant or deny the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): set of access permissions granted to user. Values: <code class="docutils literal notranslate"><span class="pre">read</span></code>, <code class="docutils literal notranslate"><span class="pre">write</span></code></p></li>
</ul>
<p>For example, if you want to allow only the user <code class="docutils literal notranslate"><span class="pre">admin</span></code> to read and write
system information, allow <code class="docutils literal notranslate"><span class="pre">alice</span></code> to read system information, and deny all other access, you
can use the following rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"system_information"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"admin"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"read"</span><span class="p">,</span> <span class="s2">"write"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"alice"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"read"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A fixed user can be set for management interfaces using the <code class="docutils literal notranslate"><span class="pre">management.user</span></code>
configuration property.  When this is configured, system information rules must still be set
to authorize this user to read or write to management information. The fixed management user
only applies to HTTP by default. To enable the fixed user over HTTPS, set the
<code class="docutils literal notranslate"><span class="pre">management.user.https-enabled</span></code> configuration property.</p>




          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="built-in-system-access-control.html" title="Built-in System Access Control"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Built-in System Access Control </span>
              </div>
            </a>
          
          
            <a href="ldap-group-provider.html" title="LDAP group provider"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> LDAP group provider </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #253746; align-content: center; height: 3em;"> 
</div>
  </body>
</html>