

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Optimizer Properties &mdash; Starburst Enterprise Presto</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="8.4. Properties Reference" href="properties.html"/>
        <link rel="next" title="Logging Properties" href="properties-logging.html"/>
        <link rel="prev" title="Node Scheduler Properties" href="properties-node-scheduler.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">3. Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mission-control.html">4. Mission Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">5. Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">7. Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../admin.html">8. Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="web-interface.html">8.1. Web UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="tuning.html">8.2. Tuning Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="jmx.html">8.3. Monitoring with JMX</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="properties.html">8.4. Properties Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="properties-general.html">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-memory-management.html">Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-query-management.html">Query Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-spilling.html">Spilling</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-exchange.html">Exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-task.html">Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-writer-scaling.html">Writer Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-node-scheduler.html">Node Scheduler</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Optimizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-dictionary-aggregation"><code class="docutils literal notranslate"><span class="pre">optimizer.dictionary-aggregation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-optimize-hash-generation"><code class="docutils literal notranslate"><span class="pre">optimizer.optimize-hash-generation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-optimize-metadata-queries"><code class="docutils literal notranslate"><span class="pre">optimizer.optimize-metadata-queries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-push-aggregation-through-join"><code class="docutils literal notranslate"><span class="pre">optimizer.push-aggregation-through-join</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-push-table-write-through-union"><code class="docutils literal notranslate"><span class="pre">optimizer.push-table-write-through-union</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-join-reordering-strategy"><code class="docutils literal notranslate"><span class="pre">optimizer.join-reordering-strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizer-max-reordered-joins"><code class="docutils literal notranslate"><span class="pre">optimizer.max-reordered-joins</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="properties-logging.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-web-interface.html">Web UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties-regexp-function.html">Regular Expression Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spill.html">8.5. Spill to Disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="resource-groups.html">8.6. Resource Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="session-property-managers.html">8.7. Session Property Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="dist-sort.html">8.8. Distributed Sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage-metrics.html">8.9. Usage Metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">9. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">10. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">11. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">12. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">13. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">14. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">15. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">16. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">17. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">339-e STS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/338-e/">Latest LTS (338-e)</option>
    <option value="/332-e/">332-e LTS</option>
    <option value="/323-e/">323-e LTS</option>
    <option value="/339-e/">Latest STS (339-e)</option>
    <option value="/336-e/">336-e STS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">339-e STS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../admin.html"><span class="section-number">8. </span>Administration</a> &raquo;</li>
      
        <li><a href="properties.html"><span class="section-number">8.4. </span>Properties Reference</a> &raquo;</li>
      
    <li>Optimizer Properties</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="optimizer-properties">
<h1>Optimizer Properties<a class="headerlink" href="#optimizer-properties" title="Permalink to this headline">#</a></h1>
<div class="section" id="optimizer-dictionary-aggregation">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.dictionary-aggregation</span></code><a class="headerlink" href="#optimizer-dictionary-aggregation" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">false</span></code></p></li>
</ul>
<p>Enables optimization for aggregations on dictionaries. This can also be specified
on a per-query basis using the <code class="docutils literal notranslate"><span class="pre">dictionary_aggregation</span></code> session property.</p>
</div>
<div class="section" id="optimizer-optimize-hash-generation">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.optimize-hash-generation</span></code><a class="headerlink" href="#optimizer-optimize-hash-generation" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">true</span></code></p></li>
</ul>
<p>Compute hash codes for distribution, joins, and aggregations early during execution,
allowing result to be shared between operations later in the query. This can reduce
CPU usage by avoiding computing the same hash multiple times, but at the cost of
additional network transfer for the hashes. In most cases it decreases overall
query processing time. This can also be specified on a per-query basis using the
<code class="docutils literal notranslate"><span class="pre">optimize_hash_generation</span></code> session property.</p>
<p>It is often helpful to disable this property, when using <a class="reference internal" href="../sql/explain.html"><span class="doc">EXPLAIN</span></a> in order
to make the query plan easier to read.</p>
</div>
<div class="section" id="optimizer-optimize-metadata-queries">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.optimize-metadata-queries</span></code><a class="headerlink" href="#optimizer-optimize-metadata-queries" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">false</span></code></p></li>
</ul>
<p>Enable optimization of some aggregations by using values that are stored as metadata.
This allows Presto to execute some simple queries in constant time. Currently, this
optimization applies to <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">approx_distinct</span></code> of partition
keys and other aggregation insensitive to the cardinality of the input,including
<code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> aggregates. Using this may speed up some queries significantly.</p>
<p>The main drawback is that it can produce incorrect results, if the connector returns
partition keys for partitions that have no rows. In particular, the Hive connector
can return empty partitions, if they were created by other systems. Presto cannot
create them.</p>
</div>
<div class="section" id="optimizer-push-aggregation-through-join">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.push-aggregation-through-join</span></code><a class="headerlink" href="#optimizer-push-aggregation-through-join" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">true</span></code></p></li>
</ul>
<p>When an aggregation is above an outer join and all columns from the outer side of the join
are in the grouping clause, the aggregation is pushed below the outer join. This optimization
is particularly useful for correlated scalar subqueries, which get rewritten to an aggregation
over an outer join. For example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">item</span> <span class="n">i</span>
    <span class="k">WHERE</span> <span class="n">i</span><span class="p">.</span><span class="n">i_current_price</span> <span class="o">&gt;</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">i_current_price</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">item</span> <span class="n">j</span>
            <span class="k">WHERE</span> <span class="n">i</span><span class="p">.</span><span class="n">i_category</span> <span class="o">=</span> <span class="n">j</span><span class="p">.</span><span class="n">i_category</span><span class="p">);</span>
</pre></div>
</div>
<p>Enabling this optimization can substantially speed up queries by reducing
the amount of data that needs to be processed by the join.  However, it may slow down some
queries that have very selective joins. This can also be specified on a per-query basis using
the <code class="docutils literal notranslate"><span class="pre">push_aggregation_through_join</span></code> session property.</p>
</div>
<div class="section" id="optimizer-push-table-write-through-union">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.push-table-write-through-union</span></code><a class="headerlink" href="#optimizer-push-table-write-through-union" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">true</span></code></p></li>
</ul>
<p>Parallelize writes when using <code class="docutils literal notranslate"><span class="pre">UNION</span> <span class="pre">ALL</span></code> in queries that write data. This improves the
speed of writing output tables in <code class="docutils literal notranslate"><span class="pre">UNION</span> <span class="pre">ALL</span></code> queries, because these writes do not require
additional synchronization when collecting results. Enabling this optimization can improve
<code class="docutils literal notranslate"><span class="pre">UNION</span> <span class="pre">ALL</span></code> speed, when write speed is not yet saturated. However, it may slow down queries
in an already heavily loaded system. This can also be specified on a per-query basis
using the <code class="docutils literal notranslate"><span class="pre">push_table_write_through_union</span></code> session property.</p>
</div>
<div class="section" id="optimizer-join-reordering-strategy">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.join-reordering-strategy</span></code><a class="headerlink" href="#optimizer-join-reordering-strategy" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">string</span></code></p></li>
<li><p><strong>Allowed values:</strong> <code class="docutils literal notranslate"><span class="pre">AUTOMATIC</span></code>, <code class="docutils literal notranslate"><span class="pre">ELIMINATE_CROSS_JOINS</span></code>, <code class="docutils literal notranslate"><span class="pre">NONE</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">AUTOMATIC</span></code></p></li>
</ul>
<p>The join reordering strategy to use.  <code class="docutils literal notranslate"><span class="pre">NONE</span></code> maintains the order the tables are listed in the
query.  <code class="docutils literal notranslate"><span class="pre">ELIMINATE_CROSS_JOINS</span></code> reorders joins to eliminate cross joins, where possible, and
otherwise maintains the original query order. When reordering joins, it also strives to maintain the
original table order as much as possible. <code class="docutils literal notranslate"><span class="pre">AUTOMATIC</span></code> enumerates possible orders, and uses
statistics-based cost estimation to determine the least cost order. If stats are not available, or if
for any reason a cost could not be computed, the <code class="docutils literal notranslate"><span class="pre">ELIMINATE_CROSS_JOINS</span></code> strategy is used. This can
be specified on a per-query basis using the <code class="docutils literal notranslate"><span class="pre">join_reordering_strategy</span></code> session property.</p>
</div>
<div class="section" id="optimizer-max-reordered-joins">
<h2><code class="docutils literal notranslate"><span class="pre">optimizer.max-reordered-joins</span></code><a class="headerlink" href="#optimizer-max-reordered-joins" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">integer</span></code></p></li>
<li><p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">9</span></code></p></li>
</ul>
<p>When optimizer.join-reordering-strategy is set to cost-based, this property determines
the maximum number of joins that can be reordered at once.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The number of possible join orders scales factorially with the number of
relations, so increasing this value can cause serious performance issues.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="properties-logging.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="Logging Properties" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="properties-node-scheduler.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="Node Scheduler Properties" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'339',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>