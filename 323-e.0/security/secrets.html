

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10.14. Starburst Secrets &mdash; Starburst Distribution of Presto 323-e.0 Documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Distribution of Presto 323-e.0 Documentation" href="../index.html"/>
        <link rel="up" title="10. Security" href="../security.html"/>
        <link rel="next" title="11. Administration" href="../admin.html"/>
        <link rel="prev" title="10.13. Credential Passthrough" href="credential-passthrough.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Distribution of Presto
          

          
          </a>

          
            
            
              <div class="version">
                323-e.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system-requirements.html">2. License and System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">3. Running Presto in a Docker container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">4. Presto on Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure.html">5. Presto on Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Presto on Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation-rpm.html">7. Presto RPM Installation using Presto Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/deployment.html">8. Presto Tarball Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">9. Presto Client Software</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../security.html">10. Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="server.html">10.1. Coordinator Kerberos Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">10.2. CLI Kerberos Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldap.html">10.3. LDAP Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="tls.html">10.4. Java Keystores and Truststores</a></li>
<li class="toctree-l2"><a class="reference internal" href="built-in-system-access-control.html">10.5. Built-in System Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldap-group-provider.html">10.6. LDAP group provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal-communication.html">10.7. Secure Internal Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="audit.html">10.8. Security Audit</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html">10.9. Role Based Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="ranger.html">10.10. Presto with Apache Ranger</a></li>
<li class="toctree-l2"><a class="reference internal" href="sentry.html">10.11. Presto with Apache Sentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="impersonation.html">10.12. User Impersonation</a></li>
<li class="toctree-l2"><a class="reference internal" href="credential-passthrough.html">10.13. Credential Passthrough</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10.14. Starburst Secrets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#java-keystore-file">Java Keystore File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alias-usage-in-properties-files">Alias Usage in Properties Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activating-keystore-as-configuration-source">Activating Keystore as Configuration Source</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">11. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">12. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">13. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">14. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">15. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">16. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">17. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">18. Older Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">19. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">20. Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Starburst Distribution of Presto</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../security.html">10. Security</a> &raquo;</li>
      
    <li>10.14. Starburst Secrets</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="../_sources/security/secrets.rst.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="starburst-secrets">
<h1>10.14. Starburst Secrets</h1>
<p>Presto manages configuration details in static properties files. This
configuration needs to include properties such as usernames, passwords and other
values, that are often required to be kept secret, and managed only by a few
select administrators.</p>
<p>Starburst Secrets allows you to configure Presto to retrieve property values
from a Java keystore file. The values are transparently injected to allow Presto
to operate as usual. The keystore file can be separately managed and contains
the secrets as encrypted values.</p>
<p>Configuration for Starburst Secrets follows a few simple steps.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#java-keystore-file" id="id1">Java Keystore File</a></li>
<li><a class="reference internal" href="#alias-usage-in-properties-files" id="id2">Alias Usage in Properties Files</a></li>
<li><a class="reference internal" href="#activating-keystore-as-configuration-source" id="id3">Activating Keystore as Configuration Source</a></li>
</ul>
</div>
<div class="section" id="java-keystore-file">
<h2><a class="toc-backref" href="#id1">Java Keystore File</a></h2>
<p>In order to move the secrets to the encrypted, secure location in the keystore
file you need create the keystore file and fill it with the desired properties.</p>
<p>In the following example, we replace the value for a <code class="docutils literal"><span class="pre">connection-password</span></code> in
a connector properties file such as <code class="docutils literal"><span class="pre">etc/catalog/mydatabase.properties</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>connection-password=SuPeRSeCrEtPassWord
</pre></div>
</div>
<p>You need to decide on an alias name for the secret, <code class="docutils literal"><span class="pre">mydatabase-password</span></code> and
then use the alias to add the secret with this alias to a keystore file.</p>
<p>Use the <code class="docutils literal"><span class="pre">keytool</span></code> command, available as part of your Java installation for
working with the keystore file.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>keytool -genseckey -alias mydatabase-password -keyalg PBE -keystore presto-keystore.pfx -storetype PKCS12
</pre></div>
</div>
<p>The above command creates the <code class="docutils literal"><span class="pre">presto-keystore.pfx</span></code> file or uses the file in
the current directory of that name. After providing the password to the
keystore, you can provide the secret value for the alias</p>
<p>To add more secrets, simply repeat the command with another alias value.</p>
<p>Once all secrets are added with the desired alias you can list them:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ keytool -list -keystore presto-keystore.pfx
Enter keystore password:
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 2 entries

mydatabase-password, 20-Nov-2019, SecretKeyEntry,
anotherdb-password, 20-Nov-2019, SecretKeyEntry,
</pre></div>
</div>
</div>
<div class="section" id="alias-usage-in-properties-files">
<h2><a class="toc-backref" href="#id2">Alias Usage in Properties Files</a></h2>
<p>With the passwords now stored in the keystore file using the desired alias
names, you have to copy the keystore file to the Presto server, e.g. to
<code class="docutils literal"><span class="pre">etc/catalog/presto-keystore.pfx</span></code>.</p>
<p>Then replace the secret values in the properties file. The new content of the
connector properties file <code class="docutils literal"><span class="pre">etc/catalog/mydatabase.properties</span></code> uses the alias
referenced as environment value:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>connection-password=${env.mydatabase-password}
</pre></div>
</div>
</div>
<div class="section" id="activating-keystore-as-configuration-source">
<h2><a class="toc-backref" href="#id3">Activating Keystore as Configuration Source</a></h2>
<p>You need to activate and configure the specific keystore file as a configuration
source, to cause Presto to read the information before the loading other
configuration files and injecting the values.</p>
<p>Provide all required properties in <code class="docutils literal"><span class="pre">etc/configuration-source.properties</span></code>, and
restart Presto for the configuration to be used:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">keystore.enabled</span><span class="o">=</span><span class="s">true</span>
<span class="na">keystore.file-path</span><span class="o">=</span><span class="s">etc/catalog/presto-keystore.pfx</span>
<span class="na">keystore.password</span><span class="o">=</span><span class="s">password_used_in_presto-keystore.pfx_creation</span>
</pre></div>
</div>
<p>Properties:</p>
<p><code class="docutils literal"><span class="pre">keystore.enabled</span></code></p>
<blockquote>
<div>Enables or disables the keystore configuration source.</div></blockquote>
<p><code class="docutils literal"><span class="pre">keystore.file-path</span></code></p>
<blockquote>
<div>Path to the keystore file on the Presto server. The supported extensions are
<code class="docutils literal"><span class="pre">*.pfx</span></code>, <code class="docutils literal"><span class="pre">*.p12</span></code> and <code class="docutils literal"><span class="pre">*.jceks</span></code>.</div></blockquote>
<p><code class="docutils literal"><span class="pre">keystore.password</span></code></p>
<blockquote>
<div>Password to the keystore. In case of <code class="docutils literal"><span class="pre">jceks</span></code> keystores, keys need to be
encrypted by the keystore password.</div></blockquote>
<p>The default path for pre-configuration file location is
<code class="docutils literal"><span class="pre">etc/configuration-source.properties</span></code>. It can be changed by providing a Java
system property <code class="docutils literal"><span class="pre">-Dpreconfig=/path/to/pre-configuration.properties</span></code>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../admin.html" class="btn btn-neutral float-right" title="11. Administration" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="credential-passthrough.html" class="btn btn-neutral" title="10.13. Credential Passthrough" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'323-e.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>