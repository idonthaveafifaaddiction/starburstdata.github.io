

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11.5. Built-in System Access Control &mdash; Starburst Distribution of Presto 323-e.0 Documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Distribution of Presto 323-e.0 Documentation" href="../index.html"/>
        <link rel="up" title="11. Security" href="../security.html"/>
        <link rel="next" title="11.6. LDAP group provider" href="ldap-group-provider.html"/>
        <link rel="prev" title="11.4. Java Keystores and Truststores" href="tls.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Distribution of Presto
          

          
          </a>

          
            
            
              <div class="version">
                323-e.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system-requirements.html">2. License and System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">3. Running Presto in a Docker container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">4. Presto on Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure.html">5. Presto on Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Presto 312e on Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation-rpm.html">7. Presto RPM Installation using Presto Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/deployment.html">8. Presto Tarball Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration-sources.html">9. Configuration Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">10. Presto Client Software</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../security.html">11. Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="server.html">11.1. Coordinator Kerberos Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">11.2. CLI Kerberos Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldap.html">11.3. LDAP Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="tls.html">11.4. Java Keystores and Truststores</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11.5. Built-in System Access Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#allow-all-system-access-control">Allow All System Access Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-only-system-access-control">Read Only System Access Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-based-system-access-control">File Based System Access Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#refresh">Refresh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#catalog-rules">Catalog Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#principal-rules">Principal Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resource-rules">Resource Rules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ldap-group-provider.html">11.6. LDAP group provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal-communication.html">11.7. Secure Internal Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="audit.html">11.8. Security Audit</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html">11.9. Role Based Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="ranger.html">11.10. Presto with Apache Ranger</a></li>
<li class="toctree-l2"><a class="reference internal" href="sentry.html">11.11. Presto with Apache Sentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="impersonation.html">11.12. User Impersonation</a></li>
<li class="toctree-l2"><a class="reference internal" href="credential-passthrough.html">11.13. Credential Passthrough</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">12. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">13. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">14. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">15. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">16. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">17. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">18. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">19. Older Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">20. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">21. Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Starburst Distribution of Presto</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../security.html">11. Security</a> &raquo;</li>
      
    <li>11.5. Built-in System Access Control</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="../_sources/security/built-in-system-access-control.rst.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="built-in-system-access-control">
<h1>11.5. Built-in System Access Control</h1>
<p>A system access control plugin enforces authorization at a global level,
before any connector level authorization. You can either use one of the built-in
plugins in Presto or provide your own by following the guidelines in
<a class="reference internal" href="../develop/system-access-control.html"><span class="doc">System Access Control</span></a>. Presto offers three built-in plugins:</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Plugin Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">allow-all</span></code> (default value)</td>
<td>All operations are permitted.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">read-only</span></code></td>
<td>Operations that read data or metadata are permitted, but
none of the operations that write data or metadata are
allowed. See <a class="reference internal" href="#read-only-system-access-control"><span class="std std-ref">Read Only System Access Control</span></a> for
details.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">file</span></code></td>
<td>Authorization checks are enforced using a config file
specified by the configuration property <code class="docutils literal"><span class="pre">security.config-file</span></code>.
See <a class="reference internal" href="#file-based-system-access-control"><span class="std std-ref">File Based System Access Control</span></a> for details.</td>
</tr>
</tbody>
</table>
<div class="section" id="allow-all-system-access-control">
<h2>Allow All System Access Control</h2>
<p>All operations are permitted under this plugin. This plugin is enabled by default.</p>
</div>
<div class="section" id="read-only-system-access-control">
<span id="id1"></span><h2>Read Only System Access Control</h2>
<p>Under this plugin, you are allowed to execute any operation that reads data or
metadata, such as <code class="docutils literal"><span class="pre">SELECT</span></code> or <code class="docutils literal"><span class="pre">SHOW</span></code>. Setting system level or catalog level
session properties is also permitted. However, any operation that writes data or
metadata, such as <code class="docutils literal"><span class="pre">CREATE</span></code>, <code class="docutils literal"><span class="pre">INSERT</span></code> or <code class="docutils literal"><span class="pre">DELETE</span></code>, is prohibited.
To use this plugin, add an <code class="docutils literal"><span class="pre">etc/access-control.properties</span></code>
file with the following contents:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>access-control.name=read-only
</pre></div>
</div>
</div>
<div class="section" id="file-based-system-access-control">
<span id="id2"></span><h2>File Based System Access Control</h2>
<p>This plugin allows you to specify access control rules in a file. To use this
plugin, add an <code class="docutils literal"><span class="pre">etc/access-control.properties</span></code> file containing two required
properties: <code class="docutils literal"><span class="pre">access-control.name</span></code>, which must be equal to <code class="docutils literal"><span class="pre">file</span></code>, and
<code class="docutils literal"><span class="pre">security.config-file</span></code>, which must be equal to the location of the config file.
For example, if a config file named <code class="docutils literal"><span class="pre">rules.json</span></code>
resides in <code class="docutils literal"><span class="pre">etc</span></code>, add an <code class="docutils literal"><span class="pre">etc/access-control.properties</span></code> with the following
contents:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>access-control.name=file
security.config-file=etc/rules.json
</pre></div>
</div>
<p>The config file is specified in JSON format.</p>
<ul class="simple">
<li>It contains the rules defining which catalog can be accessed by which user (see Catalog Rules below).</li>
<li>The principal rules specifying what principals can identify as what users (see Principal Rules below).</li>
</ul>
<p>This plugin currently only supports catalog access control rules and principal
rules. If you want to limit access on a system level in any other way, you
must implement a custom SystemAccessControl plugin
(see <a class="reference internal" href="../develop/system-access-control.html"><span class="doc">System Access Control</span></a>).</p>
<div class="section" id="refresh">
<h3>Refresh</h3>
<p>By default, when a change is made to the <code class="docutils literal"><span class="pre">security.config-file</span></code>, Presto must be restarted
to load the changes. There is an optional property to refresh the properties without requiring a
Presto restart. The refresh period is specified in the <code class="docutils literal"><span class="pre">etc/access-control.properties</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>security.refresh-period=1s
</pre></div>
</div>
</div>
<div class="section" id="catalog-rules">
<h3>Catalog Rules</h3>
<p>These rules govern the catalogs particular users can access. The user is
granted access to a catalog based on the first matching rule read from top to
bottom. If no rule matches, access is denied. Each rule is composed of the
following fields:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">user</span></code> (optional): regex to match against user name. Defaults to <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li><code class="docutils literal"><span class="pre">users</span></code> (optional): list of user names to match with. Defaults to <code class="docutils literal"><span class="pre">[]</span></code>.</li>
<li><code class="docutils literal"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li><code class="docutils literal"><span class="pre">groups</span></code> (optional): list of group names to match with. Defaults to <code class="docutils literal"><span class="pre">[]</span></code>.</li>
<li><code class="docutils literal"><span class="pre">catalog</span></code> (optional): regex to match against catalog name. Defaults to <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li><code class="docutils literal"><span class="pre">allow</span></code> (required): string indicating whether a user has access to the catalog.
This value can be <code class="docutils literal"><span class="pre">all</span></code>, <code class="docutils literal"><span class="pre">read-only</span></code> or <code class="docutils literal"><span class="pre">none</span></code>, and defaults to <code class="docutils literal"><span class="pre">none</span></code>.
Setting this value to <code class="docutils literal"><span class="pre">read-only</span></code> has the same behavior as the <code class="docutils literal"><span class="pre">read-only</span></code>
system access control plugin.</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">user</span></code> and <code class="docutils literal"><span class="pre">users</span></code> attributes are merged, so in order for a rule to apply
the user name must match the regular expression specified in <code class="docutils literal"><span class="pre">user</span></code> attribute
or be one of the user names in the <code class="docutils literal"><span class="pre">users</span></code> list.</p>
<p>For group names, a rule can be applied if at least one group name of this user
matches the <code class="docutils literal"><span class="pre">group</span></code> regular expression or is listed in the <code class="docutils literal"><span class="pre">groups</span></code> list.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>By default, all users have access to the <code class="docutils literal"><span class="pre">system</span></code> catalog. You can
override this behavior by adding a rule.</p>
<p class="last">Boolean <code class="docutils literal"><span class="pre">true</span></code> and <code class="docutils literal"><span class="pre">false</span></code> are also supported as legacy values for <code class="docutils literal"><span class="pre">allow</span></code>,
to support backwards compatibility.  <code class="docutils literal"><span class="pre">true</span></code> maps to <code class="docutils literal"><span class="pre">all</span></code>, and <code class="docutils literal"><span class="pre">false</span></code> maps to <code class="docutils literal"><span class="pre">none</span></code>.</p>
</div>
<p>For example, if you want to allow only the user <code class="docutils literal"><span class="pre">admin</span></code> to access the
<code class="docutils literal"><span class="pre">mysql</span></code> and the <code class="docutils literal"><span class="pre">system</span></code> catalog, allow users from the <code class="docutils literal"><span class="pre">finance</span></code>
and <code class="docutils literal"><span class="pre">admin</span></code> groups access to <code class="docutils literal"><span class="pre">postgres</span></code> catalog, allow all users to
access the <code class="docutils literal"><span class="pre">hive</span></code> catalog, and deny all other access, you can use the
following rules:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;catalogs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
      <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;(mysql|system)&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;groups&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;finance&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">],</span>
      <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;hive&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span>
      <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;postgresql&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="s2">&quot;read-only&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For group-based rules to match, users need to be assigned to groups by a
<a class="reference internal" href="../develop/group-provider.html"><span class="doc">Group provider</span></a>, for example <a class="reference internal" href="ldap-group-provider.html"><span class="doc">LDAP group provider</span></a>.</p>
</div>
<div class="section" id="principal-rules">
<h3>Principal Rules</h3>
<p>These rules serve to enforce a specific matching between a principal and a
specified user name. The principal is granted authorization as a user based
on the first matching rule read from top to bottom. If no rules are specified,
no checks will be performed. If no rule matches, user authorization is denied.
Each rule is composed of the following fields:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">principal</span></code> (required): regex to match and group against principal.</li>
<li><code class="docutils literal"><span class="pre">user</span></code> (optional): regex to match against user name. If matched, it
will grant or deny the authorization based on the value of <code class="docutils literal"><span class="pre">allow</span></code>.</li>
<li><code class="docutils literal"><span class="pre">principal_to_user</span></code> (optional): replacement string to substitute against
principal. If the result of the substitution is same as the user name, it will
grant or deny the authorization based on the value of <code class="docutils literal"><span class="pre">allow</span></code>.</li>
<li><code class="docutils literal"><span class="pre">allow</span></code> (required): boolean indicating whether a principal can be authorized
as a user.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You would at least specify one criterion in a principal rule. If you specify
both criteria in a principal rule, it will return the desired conclusion when
either of criteria is satisfied.</p>
</div>
<p>The following implements an exact matching of the full principal name for LDAP
and Kerberos authentication:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;catalogs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;principals&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;principal&quot;</span><span class="p">:</span> <span class="s2">&quot;(.*)&quot;</span><span class="p">,</span>
      <span class="nt">&quot;principal_to_user&quot;</span><span class="p">:</span> <span class="s2">&quot;$1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;principal&quot;</span><span class="p">:</span> <span class="s2">&quot;([^/]+)(/.*)?@.*&quot;</span><span class="p">,</span>
      <span class="nt">&quot;principal_to_user&quot;</span><span class="p">:</span> <span class="s2">&quot;$1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you want to allow users to use the exactly same name as their Kerberos principal
name, and allow <code class="docutils literal"><span class="pre">alice</span></code> and <code class="docutils literal"><span class="pre">bob</span></code> to use a group principal named as
<code class="docutils literal"><span class="pre">group&#64;example.net</span></code>, you can use the following rules.</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;catalogs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;principals&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;principal&quot;</span><span class="p">:</span> <span class="s2">&quot;([^/]+)/?.*@example.net&quot;</span><span class="p">,</span>
      <span class="nt">&quot;principal_to_user&quot;</span><span class="p">:</span> <span class="s2">&quot;$1&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;principal&quot;</span><span class="p">:</span> <span class="s2">&quot;group@example.net&quot;</span><span class="p">,</span>
      <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;alice|bob&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="resource-rules">
<span id="file-based-system-access-control-resource-rules"></span><h3>Resource Rules</h3>
<p>These rules govern the resources particular users can access. The user is
granted access to a resource based on the first matching rule read from top to
bottom. If no rule matches, access is denied. Each rule is composed of the
following fields:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">principal</span></code> (optional): regex to match against principal. Defaults to <code class="docutils literal"><span class="pre">(?s).*</span></code>.</li>
<li><code class="docutils literal"><span class="pre">resource</span></code> (optional): regex to match against resource name. Defaults to <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li><code class="docutils literal"><span class="pre">methods</span></code> (optional): a collection of HTTP verbs to match against HTTP request method.</li>
<li><code class="docutils literal"><span class="pre">allow</span></code> (required): boolean indicating whether a user has access to the catalog</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default, all authenticated users have access to all resources.</p>
</div>
<p>For example, if you want to allow the principal <code class="docutils literal"><span class="pre">bob&#64;example.com</span></code> to only be able to issue
queries and the principal <code class="docutils literal"><span class="pre">admin&#64;example.com</span></code> to have full access, you can use the following
rules:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;resources&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;principal&quot;</span><span class="p">:</span> <span class="s2">&quot;admin@example\\.com&quot;</span><span class="p">,</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;principal&quot;</span><span class="p">:</span> <span class="s2">&quot;bob@example\\.com&quot;</span><span class="p">,</span>
      <span class="nt">&quot;resource&quot;</span><span class="p">:</span> <span class="s2">&quot;/v1/statement|/v1/statement/.*&quot;</span><span class="p">,</span>
      <span class="nt">&quot;methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">],</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using secure internal communication, make sure Presto service principal has access to all
resources, similar to the <code class="docutils literal"><span class="pre">admin&#64;example.com</span></code> principal in the example above.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ldap-group-provider.html" class="btn btn-neutral float-right" title="11.6. LDAP group provider" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tls.html" class="btn btn-neutral" title="11.4. Java Keystores and Truststores" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'323-e.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>