

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="253746">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Hive level security with Apache Sentry &#8212; Starburst Enterprise Presto</title>
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/presto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User impersonation" href="impersonation.html" />
    <link rel="prev" title="Hive level security with Apache Ranger" href="hive-ranger.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#security/hive-sentry" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise Presto"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise Presto logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise Presto</span>
          <span class="md-header-nav__topic"> Hive level security with Apache Sentry </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (338-e)" href="/338-e/">Latest LTS (338-e)</a>
      
          <a title="332-e LTS" href="/332-e/">332-e LTS</a>
      
          <a title="323-e LTS" href="/323-e/">323-e LTS</a>
      
          <a title="Latest STS (341-e)" href="/341-e/">Latest STS (341-e)</a>
      
          <a title="340-e STS" href="/340-e/">340-e STS</a>
      
          <a title="339-e STS" href="/339-e/">339-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../security.html" class="md-tabs__link">Security</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise Presto" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise Presto">Starburst Enterprise Presto</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mission-control.html" class="md-nav__link">Mission Control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../kubernetes.html" class="md-nav__link">Kubernetes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="server.html" class="md-nav__link">Coordinator Kerberos Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cli.html" class="md-nav__link">CLI Kerberos Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap.html" class="md-nav__link">LDAP Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-file.html" class="md-nav__link">Password File Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-mapping.html" class="md-nav__link">User Mapping</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tls.html" class="md-nav__link">Java Keystores and Truststores</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="built-in-system-access-control.html" class="md-nav__link">Built-in System Access Control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap-group-provider.html" class="md-nav__link">LDAP group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="secrets.html" class="md-nav__link">Secrets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internal-communication.html" class="md-nav__link">Secure Internal Communication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="audit.html" class="md-nav__link">Query audit</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="event-logger.html" class="md-nav__link">Event Logger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="rbac.html" class="md-nav__link">Role based access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="system-ranger.html" class="md-nav__link">System level security with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-ranger.html" class="md-nav__link">Hive level security with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Hive level security with Apache Sentry </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Hive level security with Apache Sentry</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-hive-sentry--page-root" class="md-nav__link">Hive level security with Apache Sentry</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#before-you-begin" class="md-nav__link">Before you begin</a>
        </li>
        <li class="md-nav__item"><a href="#architecture" class="md-nav__link">Architecture</a>
        </li>
        <li class="md-nav__item"><a href="#configuring-presto-with-apache-sentry" class="md-nav__link">Configuring Presto with Apache Sentry</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#apache-sentry-configuration" class="md-nav__link">Apache Sentry configuration</a>
        </li>
        <li class="md-nav__item"><a href="#presto-configuration-for-apache-sentry" class="md-nav__link">Presto Configuration for Apache Sentry</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#group-mapping" class="md-nav__link">Group mapping</a>
        </li>
        <li class="md-nav__item"><a href="#authorization-information" class="md-nav__link">Authorization information</a>
        </li>
        <li class="md-nav__item"><a href="#caching" class="md-nav__link">Caching</a>
        </li>
        <li class="md-nav__item"><a href="#troubleshooting" class="md-nav__link">Troubleshooting</a>
        </li>
        <li class="md-nav__item"><a href="#limitations" class="md-nav__link">Limitations</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="impersonation.html" class="md-nav__link">User impersonation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="credential-passthrough.html" class="md-nav__link">Kerberos credential passthrough</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="okta-authentication.html" class="md-nav__link">Okta authentication</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">-</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">341-e STS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-hive-sentry--page-root" class="md-nav__link">Hive level security with Apache Sentry</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#before-you-begin" class="md-nav__link">Before you begin</a>
        </li>
        <li class="md-nav__item"><a href="#architecture" class="md-nav__link">Architecture</a>
        </li>
        <li class="md-nav__item"><a href="#configuring-presto-with-apache-sentry" class="md-nav__link">Configuring Presto with Apache Sentry</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#apache-sentry-configuration" class="md-nav__link">Apache Sentry configuration</a>
        </li>
        <li class="md-nav__item"><a href="#presto-configuration-for-apache-sentry" class="md-nav__link">Presto Configuration for Apache Sentry</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#group-mapping" class="md-nav__link">Group mapping</a>
        </li>
        <li class="md-nav__item"><a href="#authorization-information" class="md-nav__link">Authorization information</a>
        </li>
        <li class="md-nav__item"><a href="#caching" class="md-nav__link">Caching</a>
        </li>
        <li class="md-nav__item"><a href="#troubleshooting" class="md-nav__link">Troubleshooting</a>
        </li>
        <li class="md-nav__item"><a href="#limitations" class="md-nav__link">Limitations</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="security-hive-sentry--page-root">Hive level security with Apache Sentry<a class="headerlink" href="#security-hive-sentry--page-root" title="Permalink to this headline">#</a></h1>
<p>Apache Sentry is a granular, role-based authorization module for Hadoop. Sentry
provides the ability to control and enforce precise levels of privileges on data
for authenticated users and applications such as Presto.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hive level security with Apache Sentry requires a valid
<a class="reference internal" href="../installation/license-requirements.html"><span class="doc">Starburst Enterprise Presto license</span></a>.</p>
</div>
<p>SEP can use Apache Sentry for <a class="reference internal" href="rbac.html"><span class="doc">role-base access control</span></a> enforcing
the same and existing privileges granted on Hive objects. Presto will enforce
privileges assigned to Hive Databases, Tables, Columns, and Views. If a user
does not have a privilege to query an object, the query will fail and an error
will be returned.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The Hive level security for Apache Sentry is limited to usage with <a class="reference internal" href="../connector/starburst-hive.html"><span class="doc">Hive
connector only</span></a>. We suggest to replace it with the more
powerful <a class="reference internal" href="system-ranger.html"><span class="doc">system level security using Apache Ranger</span></a>.
It is capable of securing catalogs using other connectors and many other
aspects.</p>
</div>

<h2 id="before-you-begin">Before you begin<a class="headerlink" href="#before-you-begin" title="Permalink to this headline">#</a></h2>
<p>Before you configure Presto with Apache Sentry, verify the following prerequisites:</p>
<blockquote>
<div><ul class="simple">
<li><p>Cloudera Enterprise 5.12+ with Apache Sentry and Hive installed.</p></li>
<li><p>Presto Coordinator and Presto Workers have the appropriate network access to communicate with the
Apache Sentry Service. Typically this is port 8038.</p></li>
<li><p>If LDAP is used for user to groups mapping, Presto Coordinator and Presto Workers have the appropriate
network access to communicate with the LDAP server. Typically this is port 636 or 389.</p></li>
</ul>
</div></blockquote>
<p>If you are new to Apache Sentry, Cloudera provides excellent documentation for installing and configuring
Apache Sentry:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cloudera.com/documentation/enterprise/5-15-x/topics/sentry.html">https://www.cloudera.com/documentation/enterprise/5-15-x/topics/sentry.html</a></p></li>
</ul>


<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">#</a></h2>
<p>When a query is submitted to Presto, Presto parses and analyzes the query to understand the
privileges required by the user to access a particular object. Presto communicates with the
Apache Sentry Service to determine if the request is valid. If the request is valid, the query
continues to execute. If the request is invalid, an error is returned to the user.</p>
<p>Caching is also used to improve performance and reduce the number of requests to the Sentry service.</p>


<h2 id="configuring-presto-with-apache-sentry">Configuring Presto with Apache Sentry<a class="headerlink" href="#configuring-presto-with-apache-sentry" title="Permalink to this headline">#</a></h2>

<h3 id="apache-sentry-configuration">Apache Sentry configuration<a class="headerlink" href="#apache-sentry-configuration" title="Permalink to this headline">#</a></h3>
<p>As with Hive, Impala, Spark, and Hue, you must create a Admin Group for Presto named <code class="docutils literal notranslate"><span class="pre">presto</span></code>.
You can do this via the Cloudera Manager or manually by adding to the property,
<code class="docutils literal notranslate"><span class="pre">sentry.service.admin.group</span></code> in the <code class="docutils literal notranslate"><span class="pre">sentry-site.xml</span></code> file. The user of the Presto process
should belong to this group. Additionally you must add Presto user (from <code class="docutils literal notranslate"><span class="pre">sentry.client-principal</span></code>)
to <code class="docutils literal notranslate"><span class="pre">sentry.service.allow.connect</span></code> in <code class="docutils literal notranslate"><span class="pre">sentry-site.xml</span></code>.</p>
<p>For additional information refer to the Cloudera documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cloudera.com/documentation/enterprise/5-15-x/topics/sg_sentry_service_config.html">https://www.cloudera.com/documentation/enterprise/5-15-x/topics/sg_sentry_service_config.html</a></p></li>
</ul>


<h3 id="presto-configuration-for-apache-sentry">Presto Configuration for Apache Sentry<a class="headerlink" href="#presto-configuration-for-apache-sentry" title="Permalink to this headline">#</a></h3>
<p>SEP must be configured to enable Presto to communicate with the Apache Sentry
service. To enable set the following property in the Hive connector
configuration.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hive.security = sentry
</pre></div>
</div>
<p>Once Apache Sentry is enabled for Presto, there are additional required and optional properties to further configure. You can also see the full list of configuration properties in <a class="reference internal" href="../connector/starburst-hive-security.html#hive-sentry-authorization"><span class="std std-ref">Apache Sentry-based authorization</span></a>.</p>



<h2 id="group-mapping">Group mapping<a class="headerlink" href="#group-mapping" title="Permalink to this headline">#</a></h2>
<p>Sentry manages role permissions and the roles to user groups associations.
Sentry does not manage users to user groups associations. For this reason, any
application using Sentry needs to be configured to be able to determine a user’s
groups. In Presto, the <code class="docutils literal notranslate"><span class="pre">sentry.group-mapping</span></code> property specifies how the user
groups are determined. By default it is set to <code class="docutils literal notranslate"><span class="pre">HADOOP_DEFAULT</span></code>. See <a class="reference internal" href="../connector/starburst-hive-security.html#hive-sentry-authorization"><span class="std std-ref">Apache Sentry-based authorization</span></a> for other possible values.</p>
<p>For more information from Cloudera’s documentation, refer to:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cloudera.com/documentation/enterprise/5-15-x/topics/cm_sg_sentry_service.html#concept_hmj_d54_t4">https://www.cloudera.com/documentation/enterprise/5-15-x/topics/cm_sg_sentry_service.html#concept_hmj_d54_t4</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It may be desired to reuse your existing <code class="docutils literal notranslate"><span class="pre">sentry-site.xml</span></code> configuration instead of setting new configurations
in the Hive connector configuration. To have Presto use an XML configuration file, set <code class="docutils literal notranslate"><span class="pre">sentry.config.resources</span></code>
to the file location of a <code class="docutils literal notranslate"><span class="pre">sentry-site.xml</span></code> configuration file.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">HADOOP_DEFAULT</span></code> group mapping and <code class="docutils literal notranslate"><span class="pre">sentry.config.resources</span></code> is set,
and the provided file(s) contain a value for <code class="docutils literal notranslate"><span class="pre">hadoop.security.group.mapping</span></code>,
the configured user group mapping will be used. If you do not set <code class="docutils literal notranslate"><span class="pre">sentry.config.resources</span></code>
Presto will use Hadoop’s default behavior, which is to retrieve user groups from the local operating system.
Similarly, when using <code class="docutils literal notranslate"><span class="pre">LDAP</span></code> group mapping and you provide Hadoop configuration files using
<code class="docutils literal notranslate"><span class="pre">sentry.config.resources</span></code> property, you can abstain from setting LDAP Group mapping properties in Hive connector
configuration.</p>
</div>


<h2 id="authorization-information">Authorization information<a class="headerlink" href="#authorization-information" title="Permalink to this headline">#</a></h2>
<dl class="simple">
<dt>Sentry authorization information can be accessed by querying the following tables:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">information_schema.roles</span></code> - return information about all existing roles (equivalent of <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">ROLES</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">information_schema.applicable_roles</span></code> - return roles that are granted to current user</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">information_schema.enabled_roles</span></code> - return a list of roles that currently user is using at the moment (equivalent of <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CURRENT</span> <span class="pre">USER</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">information_schema.table_privileges</span></code> - return all tables privileges granted to user according to currently enabled roles</p></li>
</ul>
</dd>
</dl>


<h2 id="caching">Caching<a class="headerlink" href="#caching" title="Permalink to this headline">#</a></h2>
<p>There is some latency associated with making the remote procedure calls to
Apache Sentry as well as syncing LDAP groups. Presto includes a caching
mechanism so that subsequent calls can look at the cache before making the
remote call.</p>
<p>See <a class="reference internal" href="../connector/starburst-hive-security.html#hive-sentry-authorization"><span class="std std-ref">Apache Sentry-based authorization</span></a> for the cache properties along with their
default values. Depending on your use case, you may want to increase or decrease
the default ttl values.</p>


<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">#</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>If you get the exception <code class="docutils literal notranslate"><span class="pre">GSSException:</span> <span class="pre">Failure</span> <span class="pre">unspecified</span> <span class="pre">at</span> <span class="pre">GSS-API</span> <span class="pre">level</span> <span class="pre">(Mechanism</span> <span class="pre">level:</span> <span class="pre">Checksum</span> <span class="pre">failed)</span></code>
then you need to make sure you are using proper <code class="docutils literal notranslate"><span class="pre">sentry.service-principal</span></code>.</p></li>
<li><p>If you get an <code class="docutils literal notranslate"><span class="pre">SentryAccessDeniedException</span></code> exception then make sure the user that you set for <code class="docutils literal notranslate"><span class="pre">sentry.admin-user</span></code>
belongs to any group listed by <code class="docutils literal notranslate"><span class="pre">sentry.service.admin.group</span></code> in <code class="docutils literal notranslate"><span class="pre">sentry-site.xml</span></code>.</p></li>
<li><p>If Presto is not capable to connect to Kerberized Sentry and you get an exception
<code class="docutils literal notranslate"><span class="pre">Peer</span> <span class="pre">indicated</span> <span class="pre">failure:</span> <span class="pre">Problem</span> <span class="pre">with</span> <span class="pre">callback</span> <span class="pre">handler</span></code> make sure that you added the Presto user
(from <code class="docutils literal notranslate"><span class="pre">sentry.client-principal</span></code>) to <code class="docutils literal notranslate"><span class="pre">sentry.service.allow.connect</span></code> in <code class="docutils literal notranslate"><span class="pre">sentry-site</span></code>.
Additionally, make sure the letter casing matches.</p></li>
<li><p>Make sure that your <code class="docutils literal notranslate"><span class="pre">sentry.server</span></code> value is correct. It is not an IP or Hostname. It is server object name in Sentry.</p></li>
</ul>
</div></blockquote>


<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">#</a></h2>
<p>Presto only enforces the Apache Sentry policies. Presto does not support any modification of authorization policies in Sentry.
This includes commands like CREATE ROLE, GRANT, or REVOKE. If you need to modify the roles and privileges,
that must be done via another tool such as Apache Hive or Hue. Sentry Policy Files are also not supported.</p>




          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="hive-ranger.html" title="Hive level security with Apache Ranger"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Hive level security with Apache Ranger </span>
              </div>
            </a>
          
          
            <a href="impersonation.html" title="User impersonation"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> User impersonation </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #253746; align-content: center; height: 3em;"> 
</div>
  </body>
</html>