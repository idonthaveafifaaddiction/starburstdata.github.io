

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.5. Deploying Presto with Caching &mdash; Starburst Distribution of Presto 323-e.6 Documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Distribution of Presto 323-e.6 Documentation" href="../index.html"/>
        <link rel="up" title="5. Presto on Amazon Web Services" href="../aws.html"/>
        <link rel="next" title="5.6. Configuring Presto" href="configuration.html"/>
        <link rel="prev" title="5.4. Deploying Presto" href="deploy.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Distribution of Presto
          

          
          </a>

          
            
            
              <div class="version">
                323-e.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system-requirements.html">2. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mission-control.html">3. Mission Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">4. Running Presto in a Docker container</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../aws.html">5. Presto on Amazon Web Services</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">5.1. Getting Started: A Quick Guide to Presto on AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">5.2. Overview of Presto on AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="prerequisites.html">5.3. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html">5.4. Deploying Presto</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.5. Deploying Presto with Caching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deploying-a-presto-with-caching-cluster-using-cloudformation-template-web-console">Deploying a Presto with Caching Cluster Using CloudFormation Template (Web Console)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#permissions-needed-to-deploy-a-starburst-presto-cloudformation-template">Permissions needed to deploy a Starburst Presto CloudFormation Template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">5.6. Configuring Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="metastore.html">5.7. Configuring Hive Metastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="access.html">5.8. Accessing the Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html">5.9. Querying Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">5.10. Querying AWS S3</a></li>
<li class="toctree-l2"><a class="reference internal" href="glue.html">5.11. AWS Glue Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="superset.html">5.12. Using Apache Superset</a></li>
<li class="toctree-l2"><a class="reference internal" href="manualscale.html">5.13. Manual Scaling a Running Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoscale.html">5.14. Auto Scaling a Running Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="high-availability.html">5.15. Presto Coordinator High Availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">5.16. Integration with CloudWatch Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">5.17. Integration with CloudWatch metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">5.18. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="uninstall.html">5.19. Uninstalling Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="resources.html">5.20. Related Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../azure.html">6. Presto on Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">7. Presto on Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation-rpm.html">8. Presto RPM Installation using Presto Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/deployment.html">9. Presto Tarball Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">10. Presto Client Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">11. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">12. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">13. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">14. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">15. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">16. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">17. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">18. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">19. Older Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">20. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">21. Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Starburst Distribution of Presto</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../aws.html">5. Presto on Amazon Web Services</a> &raquo;</li>
      
    <li>5.5. Deploying Presto with Caching</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="../_sources/aws/deploy_caching.rst.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deploying-presto-with-caching">
<h1>5.5. Deploying Presto with Caching</h1>
<p><a class="reference external" href="https://aws.amazon.com/marketplace/pp/B07ZTHJ9YF?qid=1573146139958&amp;sr=0-3&amp;ref_=srh_res_product_title">Presto on AWS Marketplace</a> is available as both an Amazon Machine Image (AMI) and a CloudFormation template. Launching as an AMI provides a fully functional single node Presto setup – suitable for trial deployment of Presto in your development environment. The Starburst CloudFormation template is ideal for production deployment by configuring multiple Presto AMIs to form a Presto cluster consisting of a Presto Coordinator and various Presto Workers.</p>
<p>Presto’s caching is achieve using Alluxio. The Presto and Alluxio joint CloudFormation template is ideal for production deployment by configuring both Presto and Alluxio to form a joint cluster. Alluxio helps cache frequently used remote data locally to speed up Presto query performance. View <a class="reference external" href="https://docs.alluxio.io/os/user/stable/en/Overview.html">https://docs.alluxio.io/os/user/stable/en/Overview.html</a> for more information about Alluxio.</p>
<div class="contents local topic" id="presto-deployment-options">
<p class="topic-title first">Presto Deployment Options</p>
<ul class="simple">
<li><a class="reference internal" href="#deploying-a-presto-with-caching-cluster-using-cloudformation-template-web-console" id="id1">Deploying a Presto with Caching Cluster Using CloudFormation Template (Web Console)</a></li>
<li><a class="reference internal" href="#permissions-needed-to-deploy-a-starburst-presto-cloudformation-template" id="id2">Permissions needed to deploy a Starburst Presto CloudFormation Template</a></li>
</ul>
</div>
<div class="section" id="deploying-a-presto-with-caching-cluster-using-cloudformation-template-web-console">
<h2><a class="toc-backref" href="#id1">Deploying a Presto with Caching Cluster Using CloudFormation Template (Web Console)</a></h2>
<dl class="docutils">
<dt><strong>1.  Select Template</strong></dt>
<dd><p class="first">After you subscribe to the Presto offering on AWS Marketplace, you’ll be able to launch CloudFormation.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_launch.png"><img alt="../_images/presto_cft_launch.png" src="../_images/presto_cft_launch.png" style="width: 1674.0px; height: 878.0px;" /></a>
<p>This will direct you to the ‘Select Template’ step for creating a CloudFormation stack. You should find a pre-populated field under ‘Amazon S3 template URL’. This is the location of Starburst’s Presto CloudFormation template. Click ‘next’.</p>
<p>Optionally you can choose ‘Copy to Service Catalog’ for when using with the <a class="reference external" href="https://aws.amazon.com/servicecatalog/">AWS Service Catalog</a>.</p>
<a class="last reference internal image-reference" href="../_images/presto_cft_select.png"><img alt="../_images/presto_cft_select.png" src="../_images/presto_cft_select.png" style="width: 2080.0px; height: 1390.0px;" /></a>
</dd>
<dt><strong>2.  Specify Details</strong></dt>
<dd><blockquote class="first">
<div><p>Proceed by specifying the details of your Presto cluster (CloudFormation stack). This step includes network, EC2 and Presto configurations.</p>
<ul>
<li><p class="first"><strong>Preliminary Details:</strong>
Name your Presto cluster .</p>
<a class="reference internal image-reference" href="../_images/presto_cft_stackname.png"><img alt="../_images/presto_cft_stackname.png" src="../_images/presto_cft_stackname.png" style="width: 2054.0px; height: 394.0px;" /></a>
</li>
<li><p class="first"><strong>Network Configuration:</strong>
Specify your existing <strong>VPC</strong>, <strong>Subnet</strong>, and <strong>Security Groups</strong>.
It is assumed these are preconfigured in your AWS account. See the below Prerequisites sections for more detail:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="prerequisites.html#aws-vpc"><span class="std std-ref">VPC &amp; Subnets</span></a></li>
<li><a class="reference internal" href="prerequisites.html#aws-security-groups"><span class="std std-ref">Security Groups</span></a></li>
<li>Besides the ports mentioned in the Security Groups section, it’s recommended that port 19999 and 30000 are accessible in order to access the Alluxio Web UI.</li>
</ul>
</div></blockquote>
<p>Select <code class="docutils literal"><span class="pre">no</span></code> for <strong>SelectedSubnetAutoAssignsPublicIp</strong> if selected subnet does not provide public IPs. In such case VPC endpoints will be created for Presto stack.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_network.png"><img alt="../_images/presto_cft_network.png" src="../_images/presto_cft_network.png" style="width: 1974.0px; height: 802.0px;" /></a>
</li>
<li><p class="first"><strong>EC2 Configuration:</strong></p>
<p>Choose a <strong>CoordinatorInstanceType</strong> and <strong>WorkerInstanceType</strong> suitable for your workload. The <code class="docutils literal"><span class="pre">r4.4xlarge</span></code> instance types are chosen by default and work well for most workloads. Since Alluxio Master is colocated with Presto Coordinator and Alluxio worker is colocated with Presto worker, it’s suggested to choose an instance type with enough memory.</p>
<p>Choose a <strong>KeyName</strong> which is the name of an EC2 KeyPair to enable SSH access to the instance. See <a class="reference internal" href="prerequisites.html#aws-ssh"><span class="std std-ref">SSH Keys</span></a> for more detail.</p>
<p>Specify the  <strong>WorkersCount</strong> to specify the number of nodes to instantiate Presto workers and Alluxio workers. Presto worker nodes are added to an AWS AutoScaling Group. See <a class="reference internal" href="autoscale.html"><span class="doc">Auto Scaling a Running Presto Cluster</span></a> for more detail.</p>
<p>Specify the <strong>HACoordinatorsCount</strong> for Presto coordinator  and Alluxio master high availability. See <a class="reference internal" href="high-availability.html"><span class="doc">Presto Coordinator High Availability</span></a> for more detail about Presto high availability. Alluxio has a built-in mechanism to achieve high availability. See <a class="reference external" href="https://docs.alluxio.io/ee/user/stable/en/deploy/Running-Alluxio-On-a-HA-Cluster.html">Running Alluxio on a HA cluster</a> for more details.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_alluxio_ec2.png"><img alt="../_images/presto_cft_alluxio_ec2.png" src="../_images/presto_cft_alluxio_ec2.png" style="width: 1328.0px; height: 842.0px;" /></a>
</li>
<li><p class="first"><strong>Presto Configuration:</strong></p>
<p><strong>AllowExternalAccessOnHttp</strong> indicates whether you will be allowing external access on HTTP. Disabled by default,
this is to disallow external access for security purposes.
When disabled, clients (CLI/JDBC/etc) can connect to Presto only from machines in the AWS Subnet specified above.
When enabled and instances are assigned public IP, Presto endpoints will be available over HTTP without authorization
(unless eg. LDAP is configured via “Custom Configuration”).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It’s important to make sure your AWS infrastructure is set up in such a way that the Presto is not publicly accessible.</p>
</div>
<p>If you want to use the Hive connector to access data in HDFS or S3, you will need to configure Hive Metastore so Presto
knows where data lives. See <a class="reference internal" href="metastore.html"><span class="doc">Configuring Hive Metastore</span></a> for more detail.</p>
<p><strong>AdditionalCoordinatorConfigurationURI</strong> and <strong>AdditionalWorkersConfigurationURI</strong> are the locations of your custom Presto configuration if you wish to override the default configurations. Please see the section <a class="reference internal" href="configuration.html#custom-configuration"><span class="std std-ref">Custom Configuration</span></a> for more detail.</p>
<p><strong>BootstrapScriptURI</strong> is the location of your optional bash script to run on the Presto Coordinator and Worker nodes after Presto is configured but before it is launched. For example, your bash script could be used to install additional software, deploy UDFs, or deploy other plugins. When the script is executed, a string argument value of <code class="docutils literal"><span class="pre">coordinator</span></code> or <code class="docutils literal"><span class="pre">worker</span></code> is passed in. You can check for this argument value in your script to perform certain actions based on the Presto node type.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_configuration.png"><img alt="../_images/presto_cft_configuration.png" src="../_images/presto_cft_configuration.png" style="width: 1962.0px; height: 820.0px;" /></a>
</li>
</ul>
<blockquote>
<div><strong>PrestoHttpPort</strong> configures the Presto HTTP port number. By default it is set to <code class="docutils literal"><span class="pre">8080</span></code>.</div></blockquote>
</div></blockquote>
<ul class="last">
<li><p class="first"><strong>Alluxio Configuration</strong></p>
<p><strong>AlluxioS3RootMount</strong> is an existing S3 address (e.g.: s3://bucket/directory) to be mounted to Alluxio root. This parameter is required to start the Alluxio cluster. The current user account needs to have full read write permissions to this S3 address. Otherwise, S3 credentials of the root mount can be provided via the Advanced AWS S3 Configuration section.</p>
<p><strong>AlluxioProperties</strong> is an optional field to provide additional properties. Alluxio will be preconfigured with some properties values to be able to launch. Properties specified here will take precedence, overriding any preconfigured entries. The format for this field is KEY1=VALUE1,KEY2=VALUE2.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_configuration_alluxio.png"><img alt="../_images/presto_cft_configuration_alluxio.png" src="../_images/presto_cft_configuration_alluxio.png" style="width: 1252.0px; height: 434.0px;" /></a>
<ul>
<li><p class="first"><strong>Hive Connector Options:</strong></p>
<p>These options determine the Hive Metastore to use. There are several ways you configure Hive Metastore in Hive connector. You should refer to the dedicated documentation <a class="reference internal" href="metastore.html"><span class="doc">Configuring Hive Metastore</span></a> to determine your configuration.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_metastore_alluxio.png"><img alt="../_images/presto_cft_metastore_alluxio.png" src="../_images/presto_cft_metastore_alluxio.png" style="width: 1312.0px; height: 736.0px;" /></a>
</li>
<li><p class="first"><strong>Advanced AWS S3 configuration:</strong></p>
<p>With <strong>S3Endpoint</strong>, <strong>S3AccessKey</strong> and <strong>S3SecretKey</strong> it is possible to:</p>
<blockquote>
<div><ul class="simple">
<li>configure custom access credentials for AWS S3, in this case set only <strong>S3AccessKey</strong> and <strong>S3SecretKey</strong></li>
<li>configure custom AWS S3 endpoint, in this cases set only <strong>S3Endpoint</strong></li>
<li>access third-party S3-compatible storage system, in this case set all three parameters</li>
</ul>
</div></blockquote>
<p>Notice that above parameters will affect configuration of only provisioned Hive catalog.
All of these properties are optional, when not given EC2 instance default values are used.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_s3_configuration.png"><img alt="../_images/presto_cft_s3_configuration.png" src="../_images/presto_cft_s3_configuration.png" style="width: 1968.0px; height: 584.0px;" /></a>
</li>
<li><p class="first"><strong>Monitoring:</strong></p>
<p>Indicate if you want to enable integration with CloudWatch metrics. When enabled, OS and Presto metrics will be reported for each cluster node. Additionally, a CloudWatch Dashboard with cluster overview will be created. Additional CloudWatch fees are charged. Please refer to <a class="reference internal" href="metrics.html"><span class="doc">Integration with CloudWatch metrics</span></a> for more detail.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_monitoring.png"><img alt="../_images/presto_cft_monitoring.png" src="../_images/presto_cft_monitoring.png" style="width: 1958.0px; height: 260.0px;" /></a>
</li>
<li><p class="first"><strong>Advanced:</strong></p>
<p>Optionally specificy the <strong>InstanceProfile</strong> to attach to Presto nodes. See <a class="reference internal" href="prerequisites.html#aws-instance-profiles"><span class="std std-ref">Instance Profiles</span></a> for more detail. If you do not specificy the InstanceProfile, the CloudFormation Template will create the necessary IAM Role privleges. Alluxio adds DescribeAutoScalingGroups permission for configuring internal high availability and S3 related permissions for accessing AlluxioS3RootMount.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_iam.png"><img alt="../_images/presto_cft_iam.png" src="../_images/presto_cft_iam.png" style="width: 1964.0px; height: 288.0px;" /></a>
</li>
<li><p class="first"><strong>Other:</strong></p>
<p>Indicate whether you will be launching Apache Superset.</p>
<a class="reference internal image-reference" href="../_images/presto_cft_superset.png"><img alt="../_images/presto_cft_superset.png" src="../_images/presto_cft_superset.png" style="width: 1962.0px; height: 262.0px;" /></a>
</li>
</ul>
</li>
</ul>
</dd>
<dt><strong>3. Options</strong></dt>
<dd>Enter any additional stack specifications as shown on the Options page. These options include adding tags to resources within your cluster, choosing IAM roles, and specifying monitoring time for rollback triggers, among other advanced specifications. For further insight into said options follow the link to the <a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html">AWS CloudFormation documentation</a>.</dd>
</dl>
<dl class="docutils">
<dt><strong>4. Review</strong></dt>
<dd><blockquote class="first">
<div>Finally, review the details of your Presto and Alluxio joint cluster. When content, proceed by pressing create to conclude the creation.</div></blockquote>
<p class="last">Note: Just above the final “Create stack” button there will be a blue box informing you that <em>The following resource(s) require capabilities: [AWS::IAM::Role]</em>.
In order to create the Stack you need to mark the checkbox next to <em>I acknowledge that AWS CloudFormation might create IAM resources.</em></p>
</dd>
</dl>
</div>
<div class="section" id="permissions-needed-to-deploy-a-starburst-presto-cloudformation-template">
<h2><a class="toc-backref" href="#id2">Permissions needed to deploy a Starburst Presto CloudFormation Template</a></h2>
<p>A user launching a CloudFormation Stack, whether via the AWS Web Console or AWS CLI, needs to have a set of permissions that will allow the creation of all necessary Stack resources.
Please see the <a class="reference internal" href="prerequisites.html#aws-security-prereq-cft"><span class="std std-ref">IAM Role Permissions for CloudFormation</span></a> section for details.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configuration.html" class="btn btn-neutral float-right" title="5.6. Configuring Presto" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deploy.html" class="btn btn-neutral" title="5.4. Deploying Presto" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'323-e.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>