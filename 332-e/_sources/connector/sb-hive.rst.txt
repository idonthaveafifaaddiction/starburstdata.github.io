========================
Starburst Hive Connector
========================

The Starburst Hive Connector is an extended version of the
:doc:`/connector/hive` with configuration and usage identical.

The following improvements are included: 

.. contents::
  :local:

HDFS Permissions
----------------

Before running any ``CREATE TABLE`` or ``CREATE TABLE ... AS`` statements for
Hive tables in Presto, you need to check that the operating system user running
the Presto server has access to the Hive warehouse directory on HDFS. 

The Hive warehouse directory is specified by the configuration variable
``hive.metastore.warehouse.dir`` in ``hive-site.xml``, and the default value is
``/user/hive/warehouse``. If that is not the case, either add the following to
``jvm.config`` on all of the nodes: ``-DHADOOP_USER_NAME=USER``, where ``USER``
is an operating system user that has proper permissions for the Hive warehouse
directory, or start the Presto server as a user with similar permissions. The
``hive`` user generally works as ``USER``, since Hive is often started with the
``hive`` user. If you run into HDFS permissions problems on ``CREATE TABLE ...
AS``, remove ``/tmp/presto-*`` on HDFS, fix the user as described above, then
restart all of the Presto servers.

Apache Sentry-Based Authorization
---------------------------------

The connector supports Apache Sentry usage for authorization with the details
documented in :ref:`hive-sentry-authorization`.

Transactional and ORC ACID Tables
---------------------------------

When connecting to Hive metastore version 3, the Hive connector supports reading
from the following types of transactional tables:

- insert-only and ACID,
- partitioned and not partitioned,
- bucketed and not bucketed.

Materialized Views
------------------

The Hive connector supports reading from Hive materialized views. In Presto,
these views are presented as regular, read-only tables.


Amazon Glue Support
-------------------

Statistics collection is supported for Hive Metastore and Amazon Glue.

Configuring and using Presto with AWS Glue is described in the :doc:`/aws/glue` documentation section.


HDFS Erasure Coding
-------------------

Hive connector supports Hadoop 3's HDFS Erasure Coding.


Limitations
-----------

The following limitation apply in addition to the limitations of the
:doc:`/connector/hive`.

* Writing to and creation of transactional tables is not supported.
* Reading ORC ACID tables created with Hive Streaming ingest is not supported.

Hive 3 Related Limitations
^^^^^^^^^^^^^^^^^^^^^^^^^^

* For security reasons, ``sys`` system catalog is not accessible in Presto.
* Hive's ``timestamp with local zone`` data type is not supported in Presto.
  It is possible to read from a table having a column of this type, but the column
  itself will not be accessible. Writing to such a table is not supported.
* Due to Hive issues `HIVE-21002 <https://issues.apache.org/jira/browse/HIVE-21002>`_,
  `HIVE-22167 <https://issues.apache.org/jira/browse/HIVE-22167>`_, Presto does
  not correctly read ``timestamp`` values from Parquet, RCFile with binary serde and
  Avro file formats created by Hive 3.1 or later. When reading from these file formats,
  Presto will return different results.

