

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Presto Kubernetes resource &#8212; Starburst Enterprise Presto</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/presto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Querying Presto" href="query.html" />
    <link rel="prev" title="Deployment of Presto on Kubernetes" href="deployment.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#kubernetes/presto_resource" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise Presto"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise Presto logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise Presto</span>
          <span class="md-header-nav__topic"> Presto Kubernetes resource </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (345-e)" href="/345-e/">Latest LTS (345-e)</a>
      
          <a title="338-e LTS" href="/338-e/">338-e LTS</a>
      
          <a title="332-e LTS" href="/332-e/">332-e LTS</a>
      
          <a title="323-e LTS" href="/323-e/">323-e LTS</a>
      
          <a title="Latest STS (344-e)" href="/344-e/">Latest STS (344-e)</a>
      
          <a title="343-e STS" href="/343-e/">343-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../kubernetes.html" class="md-tabs__link">Kubernetes operator</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise Presto" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise Presto">Starburst Enterprise Presto</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../kubernetes.html" class="md-nav__link">Kubernetes operator</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="prerequisites.html" class="md-nav__link">Prerequisites</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="deployment.html" class="md-nav__link">Deployment of Presto on Kubernetes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Presto Kubernetes resource </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Presto Kubernetes resource</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#kubernetes-presto-resource--page-root" class="md-nav__link">Presto Kubernetes resource</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#general-properties" class="md-nav__link">General properties</a>
        </li>
        <li class="md-nav__item"><a href="#service-properties" class="md-nav__link">Service Properties</a>
        </li>
        <li class="md-nav__item"><a href="#general-memory-properties" class="md-nav__link">General Memory Properties</a>
        </li>
        <li class="md-nav__item"><a href="#coordinator-properties" class="md-nav__link">Coordinator Properties</a>
        </li>
        <li class="md-nav__item"><a href="#worker-properties" class="md-nav__link">Worker Properties</a>
        </li>
        <li class="md-nav__item"><a href="#readiness-and-liveness-probe" class="md-nav__link">Readiness and Liveness Probe</a>
        </li>
        <li class="md-nav__item"><a href="#usage-metrics" class="md-nav__link">Usage Metrics</a>
        </li>
        <li class="md-nav__item"><a href="#spill-to-disk-properties" class="md-nav__link">Spill to Disk Properties</a>
        </li>
        <li class="md-nav__item"><a href="#hive-connector-properties" class="md-nav__link">Hive Connector Properties</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#external-metastore" class="md-nav__link">External Metastore</a>
        </li>
        <li class="md-nav__item"><a href="#internal-metastore" class="md-nav__link">Internal Metastore</a>
        </li>
        <li class="md-nav__item"><a href="#customizing-internal-hive-metastore-pod" class="md-nav__link">Customizing Internal Hive Metastore Pod</a>
        </li>
        <li class="md-nav__item"><a href="#customizing-internal-postgresql-docker-pod" class="md-nav__link">Customizing Internal PostgreSQL Docker Pod</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#prometheus-support" class="md-nav__link">Prometheus Support</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="query.html" class="md-nav__link">Querying Presto</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="customizing_presto_image.html" class="md-nav__link">Customizing Presto Docker images</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hpa.html" class="md-nav__link">Horizontal scaling</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="secrets.html" class="md-nav__link">Secrets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ranger.html" class="md-nav__link">Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="eks.html" class="md-nav__link">Using Amazon Elastic Kubernetes Service</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gcp-marketplace.html" class="md-nav__link">GCP Marketplace</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gke.html" class="md-nav__link">Using Google Kubernetes Engine</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="azure-marketplace.html" class="md-nav__link">Azure Marketplace</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="aks.html" class="md-nav__link">Using Microsoft Azure Kubernetes Service</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="openshift.html" class="md-nav__link">Using Red Hat OpenShift</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="release_notes.html" class="md-nav__link">Kubernetes resources release notes</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">346-e LTS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">-</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#kubernetes-presto-resource--page-root" class="md-nav__link">Presto Kubernetes resource</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#general-properties" class="md-nav__link">General properties</a>
        </li>
        <li class="md-nav__item"><a href="#service-properties" class="md-nav__link">Service Properties</a>
        </li>
        <li class="md-nav__item"><a href="#general-memory-properties" class="md-nav__link">General Memory Properties</a>
        </li>
        <li class="md-nav__item"><a href="#coordinator-properties" class="md-nav__link">Coordinator Properties</a>
        </li>
        <li class="md-nav__item"><a href="#worker-properties" class="md-nav__link">Worker Properties</a>
        </li>
        <li class="md-nav__item"><a href="#readiness-and-liveness-probe" class="md-nav__link">Readiness and Liveness Probe</a>
        </li>
        <li class="md-nav__item"><a href="#usage-metrics" class="md-nav__link">Usage Metrics</a>
        </li>
        <li class="md-nav__item"><a href="#spill-to-disk-properties" class="md-nav__link">Spill to Disk Properties</a>
        </li>
        <li class="md-nav__item"><a href="#hive-connector-properties" class="md-nav__link">Hive Connector Properties</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#external-metastore" class="md-nav__link">External Metastore</a>
        </li>
        <li class="md-nav__item"><a href="#internal-metastore" class="md-nav__link">Internal Metastore</a>
        </li>
        <li class="md-nav__item"><a href="#customizing-internal-hive-metastore-pod" class="md-nav__link">Customizing Internal Hive Metastore Pod</a>
        </li>
        <li class="md-nav__item"><a href="#customizing-internal-postgresql-docker-pod" class="md-nav__link">Customizing Internal PostgreSQL Docker Pod</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#prometheus-support" class="md-nav__link">Prometheus Support</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="kubernetes-presto-resource--page-root">Presto Kubernetes resource<a class="headerlink" href="#kubernetes-presto-resource--page-root" title="Permalink to this headline">#</a></h1>
<p>A Presto Kubernetes resource represents a specific Presto cluster. The YAML file
allows you to specify various properties related to the coordinator and
workers, the catalogs and the cluster overall.</p>
<p>The following snippet shows all available properties with defaults. When
defining your particular Presto cluster resource, you need to specify <strong>only</strong>
the properties with non-default values.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">starburstdata.com/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Presto</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">presto-cluster-name</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">nameOverride</span><span class="p">:</span> <span class="s">""</span>
  <span class="nt">clusterDomain</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cluster.local</span>
  <span class="nt">environment</span><span class="p">:</span> <span class="s">""</span>
  <span class="nt">additionalJvmConfigProperties</span><span class="p">:</span> <span class="s">""</span>
  <span class="nt">additionalCatalogs</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">additionalEtcPrestoTextFiles</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">additionalEtcPrestoBinaryFiles</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">licenseSecretName</span><span class="p">:</span> <span class="s">""</span>
  <span class="nt">imageNamePrefix</span><span class="p">:</span> <span class="s">""</span>
  <span class="nt">additionalBootstrapScriptVolume</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">additionalBootstrapScriptVolumes</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">additionalVolumes</span><span class="p">:</span> <span class="p p-Indicator">[]</span>

  <span class="nt">prometheus</span><span class="p">:</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">additionalRules</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

  <span class="nt">service</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">additionalSpecProperties</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">nodePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">31234</span>

  <span class="nt">image</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">starburstdata/presto:346-e-k8s-0.43</span>
    <span class="nt">pullPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Always</span>

  <span class="nt">memory</span><span class="p">:</span>
    <span class="nt">nodeMemoryHeadroom</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2Gi</span>
    <span class="nt">xmxToTotalMemoryRatio</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.9</span>
    <span class="nt">heapHeadroomPerNodeRatio</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.3</span>
    <span class="nt">queryMaxMemory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1Pi</span>
    <span class="nt">queryMaxTotalMemoryPerNodePoolFraction</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.333</span>

  <span class="nt">coordinator</span><span class="p">:</span>
    <span class="nt">cpuLimit</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">cpuRequest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">16</span>
    <span class="nt">memoryAllocation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60Gi</span>
    <span class="nt">nodeSelector</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">affinity</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">additionalAnnotations</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

  <span class="nt">worker</span><span class="p">:</span>
    <span class="nt">count</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
    <span class="nt">autoscaling</span><span class="p">:</span>
      <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
      <span class="nt">minReplicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="nt">maxReplicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
      <span class="nt">targetCPUUtilizationPercentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
    <span class="nt">deploymentTerminationGracePeriodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7200</span> <span class="c1"># 2 hours</span>
    <span class="nt">prestoWorkerShutdownGracePeriodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">120</span>
    <span class="nt">cpuLimit</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">cpuRequest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">16</span>
    <span class="nt">memoryAllocation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100Gi</span>
    <span class="nt">nodeSelector</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">affinity</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">additionalAnnotations</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

  <span class="nt">readinessProbe</span><span class="p">:</span>
    <span class="nt">initialDelaySeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
    <span class="nt">periodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
    <span class="nt">timeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>

  <span class="nt">livenessProbe</span><span class="p">:</span>
    <span class="nt">initialDelaySeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
    <span class="nt">periodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
    <span class="nt">failureThreshold</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">timeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>

  <span class="nt">spilling</span><span class="p">:</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">volume</span><span class="p">:</span>
      <span class="nt">emptyDir</span><span class="p">:</span> <span class="p p-Indicator">{}</span>

  <span class="nt">usageMetrics</span><span class="p">:</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">usageClient</span><span class="p">:</span>
      <span class="nt">initialDelay</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
      <span class="nt">interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>

  <span class="nt">hive</span><span class="p">:</span>
    <span class="nt">metastoreUri</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">awsSecretName</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">googleServiceAccountKeySecretName</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">azureWasbSecretName</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">azureAbfsSecretName</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">azureAdlSecretName</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">additionalProperties</span><span class="p">:</span> <span class="s">""</span>
    <span class="nt">internalMetastore</span><span class="p">:</span>
      <span class="nt">mySql</span><span class="p">:</span>
        <span class="nt">jdbcUrl</span><span class="p">:</span> <span class="s">""</span>
        <span class="nt">username</span><span class="p">:</span> <span class="s">""</span>
        <span class="nt">password</span><span class="p">:</span> <span class="s">""</span>
      <span class="nt">postgreSql</span><span class="p">:</span>
        <span class="nt">jdbcUrl</span><span class="p">:</span> <span class="s">""</span>
        <span class="nt">username</span><span class="p">:</span> <span class="s">""</span>
        <span class="nt">password</span><span class="p">:</span> <span class="s">""</span>
      <span class="nt">internalPostgreSql</span><span class="p">:</span>
        <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="nt">image</span><span class="p">:</span>
          <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">postgres:9.6.10</span>
          <span class="nt">pullPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
        <span class="nt">storage</span><span class="p">:</span>
          <span class="nt">className</span><span class="p">:</span> <span class="s">""</span>
          <span class="nt">size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10Gi</span>
          <span class="nt">claimSelector</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
        <span class="nt">memory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2Gi</span>
        <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
        <span class="nt">nodeSelector</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
        <span class="nt">affinity</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
      <span class="nt">s3Endpoint</span><span class="p">:</span> <span class="s">""</span>
      <span class="nt">image</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">starburstdata/hive-metastore:k8s-0.7</span>
        <span class="nt">pullPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
      <span class="nt">memory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6Gi</span>
      <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="nt">nodeSelector</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
      <span class="nt">affinity</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</pre></div>
</div>

<span id="k8s-general"></span><h2 id="general-properties">General properties<a class="headerlink" href="#general-properties" title="Permalink to this headline">#</a></h2>
<table id="id1">
<caption><span class="caption-text">General properties</span><a class="headerlink" href="#id1" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nameOverride</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">nameOverride:</span> <span class="pre">presto-cluster</span></code></p></td>
<td><p>Presto Operator by default assigns a unique name to various Kubernetes
resources (e.g. Services). The name consists of the cluster name and a
unique suffix. Use this property to assign a static name instead.</p></td>
</tr>
<tr class="row-odd"><td><p>clusterDomain</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">clusterDomain:</span> <span class="pre">cluster-domain.example</span></code></p></td>
<td><p>Domain of the K8s cluster.</p></td>
</tr>
<tr class="row-even"><td><p>environment</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">environment:</span> <span class="pre">production</span></code></p></td>
<td><p>The name of the Presto cluster environment.</p></td>
</tr>
<tr class="row-odd"><td><p>additionalJvmConfigProperties</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalJvmConfigProperties</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">-XX:NewRatio=4</span>
  <span class="no">-XX:SurvivorRatio=</span>
</pre></div>
</div>
</td>
<td><p>Specify additional properties for the <a class="reference internal" href="../installation/deployment.html#presto-jvm-config"><span class="std std-ref">configuration of the JVM
running Presto</span></a>. Properties are appended to the
default configuration.</p></td>
</tr>
<tr class="row-even"><td><p>additionalCatalogs</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalCatalogs</span><span class="p">:</span>
  <span class="nt">tpcds</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">connector.name=tpcds</span>
  <span class="nt">jmx</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">connector.name=jmx</span>
  <span class="nt">cms</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">connector.name=postgresql</span>
    <span class="no">connection-url=jdbc:postgresql://example.com:5432/cmsdb</span>
    <span class="no">connection-user=myuser</span>
    <span class="no">connection-password=mypassword</span>
</pre></div>
</div>
</td>
<td><p>Add one or more catalogs with the relevant properties files. The element
name determines the name of the catalog and the multi-line text sets the
content of the properties file.</p></td>
</tr>
<tr class="row-odd"><td><p>additionalEtcPrestoTextFiles</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalEtcPrestoTextFiles</span><span class="p">:</span>
  <span class="nt">access-control.properties</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">access-control.name=read-only</span>
  <span class="nt">event-listener.properties</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">event-listener.name=event-logger</span>
    <span class="no">jdbc.url=jdbc:postgresql://example.com:5432/eventlog</span>
    <span class="no">jdbc.user=myuser</span>
    <span class="no">jdbc.password=mypassword</span>
</pre></div>
</div>
</td>
<td><p>Add one or more configuration text files to the <code class="docutils literal notranslate"><span class="pre">etc</span></code> folder used by
Presto. The element name determines the filename and the multi-line text
sets the content of the file.</p></td>
</tr>
<tr class="row-even"><td><p>additionalEtcPrestoBinaryFiles</p></td>
<td></td>
<td><p>Add one or more binary files to the <code class="docutils literal notranslate"><span class="pre">etc</span></code> folder used by Presto. The
configuration of is similar to the preceding text file configuration. The
element name determines the filename and the multi-line text element
needs to contain a base64 encoded content of the binary file.</p></td>
</tr>
<tr class="row-odd"><td><p>licenseSecretName</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">licenseSecretName:</span> <span class="pre">license_secret</span></code></p></td>
<td><p>Name of a Kubernetes Secret that contains a <a class="reference internal" href="../installation/license-requirements.html"><span class="doc">SEP license file</span></a>. The license file within the secret
should be named <code class="code docutils literal notranslate"><span class="pre">signed.license</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>imageNamePrefix</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">imageNamePrefix:</span> <span class="pre">gcr.io/project-name/</span></code></p></td>
<td><p>Specifies prefix of Docker image names used by the Presto cluster. This
property enables using a private Docker registry.</p></td>
</tr>
<tr class="row-odd"><td><p>image</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">image</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">org/name:tag</span>
  <span class="nt">pullPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
</pre></div>
</div>
</td>
<td><p>Image section allows you to specify a custom Docker image to be used by
the cluster with organization namespace, image name and tag.</p></td>
</tr>
<tr class="row-even"><td><p>additionalBootstrapScriptVolume</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalBootstrapScriptVolume</span><span class="p">:</span>
  <span class="nt">configMap</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-bootstrap-script</span>
</pre></div>
</div>
</td>
<td><p>Property of coordinator and worker pod. Allows adding <a class="reference internal" href="customizing_presto_image.html#k8s-custom-bootstrap"><span class="std std-ref">a custom
bootstrap script</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>additionalBootstrapScriptVolumes</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalBootstrapScriptVolumes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">configMap</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-bootstrap-script-1</span>
  <span class="p p-Indicator">-</span> <span class="nt">configMap</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-bootstrap-script-2</span>
</pre></div>
</div>
</td>
<td><p>Property of coordinator and worker pod. Allows adding <a class="reference internal" href="customizing_presto_image.html#k8s-custom-bootstrap"><span class="std std-ref">a custom
bootstrap script</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>additionalVolumes</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalVolumes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span>
    <span class="nt">emptyDir</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-bootstrap-script-1</span>
  <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/var/lib/presto/cache1</span>
      <span class="l l-Scalar l-Scalar-Plain">volume</span><span class="p p-Indicator">:</span>
      <span class="nt">hostPath</span><span class="p">:</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/media/nv1/presto-cache</span>
  <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/var/lib/presto/cache2</span>
    <span class="nt">volume</span><span class="p">:</span>
      <span class="nt">hostPath</span><span class="p">:</span>
        <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/media/nv2/presto-cache</span>
</pre></div>
</div>
</td>
<td><p>Add one or more <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/#types-of-volumes">volumes supported by k8s</a>,
to all nodes in the cluster. Optionally, it can be mounted on a specific
path by adding it to the container image. You can use this feature to add
one or more volumes and use them to <a class="reference internal" href="../connector/hive-caching.html"><span class="doc">cache distributed storage
objects</span></a>.</p></td>
</tr>
</tbody>
</table>


<span id="k8s-service"></span><h2 id="service-properties">Service Properties<a class="headerlink" href="#service-properties" title="Permalink to this headline">#</a></h2>
<p>Access to coordinator is possible via the Kubernetes Service. By default the
service is only accessible within the Kubernetes cluster at
<code class="code docutils literal notranslate"><span class="pre">http://presto-coordinator-CLUSTER_NAME_UUID.NAMESPACE.svc.cluster.local:8080</span></code>,
where <code class="code docutils literal notranslate"><span class="pre">NAMESPACE</span></code> is the Kubernetes namespace where the given Presto
cluster is deployed and <code class="code docutils literal notranslate"><span class="pre">CLUSTER_NAME_UUID</span></code> is the cluster name with
unique suffix appended.</p>
<p>Use the <code class="code docutils literal notranslate"><span class="pre">service.name</span></code> Presto resource parameter to make the service name
more predictable. For example, setting <code class="code docutils literal notranslate"><span class="pre">service.name=test-cluster</span></code> causes
the coordinator service address to be
<code class="code docutils literal notranslate"><span class="pre">http://presto-coordinator-test-cluster.NAMESPACE.svc.cluster.local:8080</span></code>.</p>
<p>Use the <code class="code docutils literal notranslate"><span class="pre">nameOverride</span></code> parameter in order to set <code class="code docutils literal notranslate"><span class="pre">CLUSTER_NAME_UUID</span></code>
to a different value.</p>
<p>You can also change type of the coordinator Service using the
<code class="code docutils literal notranslate"><span class="pre">service.type</span></code> parameter. For more information on Kubernetes Service
types, refer to <a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types">Kubernetes Services types</a>.</p>
<p>You can add additional parameters to <em>spec</em> section of Service by using
<code class="code docutils literal notranslate"><span class="pre">service.additionalSpecProperties</span></code> Presto resource parameter, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">service</span><span class="p">:</span>
  <span class="nt">additionalSpecProperties</span><span class="p">:</span>
    <span class="nt">loadBalancerIP</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">78.11.24.19</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
</pre></div>
</div>
<p>Use <code class="code docutils literal notranslate"><span class="pre">service.nodePort</span></code> parameter to specify the port on which Presto
Coordinator Service should be exposed when <code class="code docutils literal notranslate"><span class="pre">service.type</span></code> is set to
<code class="code docutils literal notranslate"><span class="pre">NodePort</span></code>, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">service</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NodePort</span>
  <span class="nt">nodePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3001</span>
</pre></div>
</div>


<span id="k8s-memory"></span><h2 id="general-memory-properties">General Memory Properties<a class="headerlink" href="#general-memory-properties" title="Permalink to this headline">#</a></h2>
<p>The <code class="code docutils literal notranslate"><span class="pre">memory</span></code> section specifies general Presto memory configuration.</p>
<table id="id2">
<caption><span class="caption-text">General memory properties</span><a class="headerlink" href="#id2" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>memory.nodeMemoryHeadroom</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">memory</span><span class="p">:</span>
  <span class="nt">nodeMemoryHeadroom</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2Gi</span>
</pre></div>
</div>
</td>
<td><p>Memory headroom that Presto should leave on a node when Presto pods are
configured to use entire node  memory (empty <code class="code docutils literal notranslate"><span class="pre">memoryAllocation</span></code>
configuration property).</p></td>
</tr>
<tr class="row-odd"><td><p>memory.xmxToTotalMemoryRatio</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">memory</span><span class="p">:</span>
  <span class="nt">xmxToTotalMemoryRatio</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.9</span>
</pre></div>
</div>
</td>
<td><p>Ratio between Presto JVM heap size and memory available for a Presto pod.</p></td>
</tr>
<tr class="row-even"><td><p>memory.heapHeadroomPerNodeRatio</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">memory</span><span class="p">:</span>
  <span class="nt">heapHeadroomPerNodeRatio</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.3</span>
</pre></div>
</div>
</td>
<td><p>Ratio between <code class="code docutils literal notranslate"><span class="pre">memory.heap-headroom-per-node</span></code> Presto configuration
property and Presto JVM heap size.</p></td>
</tr>
<tr class="row-odd"><td><p>memory.queryMaxMemory</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">memory</span><span class="p">:</span>
  <span class="nt">queryMaxMemory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1Pi</span>
</pre></div>
</div>
</td>
<td><p>Value of the <code class="code docutils literal notranslate"><span class="pre">query.max-memory</span></code> Presto configuration property.</p></td>
</tr>
<tr class="row-even"><td><p>memory.queryMaxTotalMemoryPerNodePoolFraction</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">memory</span><span class="p">:</span>
  <span class="nt">queryMaxTotalMemoryPerNodePoolFraction</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.333</span>
</pre></div>
</div>
</td>
<td><p>Value the <code class="code docutils literal notranslate"><span class="pre">query.max-total-memory-per-node</span></code> Presto configuration
property expressed as fraction of Presto JVM heap size</p></td>
</tr>
</tbody>
</table>


<span id="k8s-coordinator"></span><h2 id="coordinator-properties">Coordinator Properties<a class="headerlink" href="#coordinator-properties" title="Permalink to this headline">#</a></h2>
<p>All coordinator properties are nested within <code class="docutils literal notranslate"><span class="pre">coordinator</span></code>.</p>
<table id="id3">
<caption><span class="caption-text">Coordinator properties</span><a class="headerlink" href="#id3" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cpuRequest and cpuLimit</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">coordinator</span><span class="p">:</span>
  <span class="nt">cpuRequest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
  <span class="nt">cpuLimit</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">32</span>
</pre></div>
</div>
</td>
<td><p>Specifies the coordinator pod’s CPU limit and request.</p></td>
</tr>
<tr class="row-odd"><td><p>memoryAllocation</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">coordinator</span><span class="p">:</span>
  <span class="nt">memoryAllocation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60Gi</span>
</pre></div>
</div>
</td>
<td><p>Specifies coordinator pod’s memory usage (both request and limit). If
empty, the coordinator pod utilizes the entire memory available on the
node.</p></td>
</tr>
<tr class="row-even"><td><p>nodeSelector and affinity</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">coordinator</span><span class="p">:</span>
  <span class="nt">nodeSelector</span><span class="p">:</span>
    <span class="nt">role</span><span class="p">:</span> <span class="s">"presto"</span>
  <span class="nt">affinity</span><span class="p">:</span>
    <span class="nt">podAffinity</span><span class="p">:</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</td>
<td><p>Specifies the coordinator pod’s node selector and affinity.</p></td>
</tr>
<tr class="row-odd"><td><p>additionalProperties</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">coordinator</span><span class="p">:</span>
  <span class="nt">additionalProperties</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">resource-groups.config-file=filename</span>
</pre></div>
</div>
</td>
<td><p>Specify additional <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">configuration properties</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>additionalAnnotations</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>


<span id="k8s-worker"></span><h2 id="worker-properties">Worker Properties<a class="headerlink" href="#worker-properties" title="Permalink to this headline">#</a></h2>
<p>All worker properties are nested within <code class="docutils literal notranslate"><span class="pre">worker</span></code>.</p>
<table id="id4">
<caption><span class="caption-text">Worker properties</span><a class="headerlink" href="#id4" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>count</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">count</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
</pre></div>
</div>
</td>
<td><p>Number of worker pods.</p></td>
</tr>
<tr class="row-odd"><td><p>autoscaling</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">autoscaling</span><span class="p">:</span>
    <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">minReplicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">maxReplicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class="nt">targetCPUUtilizationPercentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</pre></div>
</div>
</td>
<td><p>Configuration of workers autoscaling.</p></td>
</tr>
<tr class="row-even"><td><p>deploymentTerminationGracePeriodSeconds</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">deploymentTerminationGracePeriodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7200</span>
</pre></div>
</div>
</td>
<td><p>Specifies termination grace period for workers pods. Worker pods are not
terminated until queries running on the pod are finished or grace period
passes.</p></td>
</tr>
<tr class="row-odd"><td><p>prestoWorkerShutdownGracePeriodSeconds</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>cpuRequest and cpuLimit</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">cpuRequest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
  <span class="nt">cpuLimit</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">32</span>
</pre></div>
</div>
</td>
<td><p>Specifies worker pod CPU limit and request.</p></td>
</tr>
<tr class="row-odd"><td><p>memoryAllocation</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">memoryAllocation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100Gi</span>
</pre></div>
</div>
</td>
<td><p>Specifies worker pod memory usage (both request and limit). If empty, the
worker pod utilizes the entire memory available on the node.</p></td>
</tr>
<tr class="row-even"><td><p>nodeSelector and affinity</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">nodeSelector</span><span class="p">:</span>
    <span class="nt">role</span><span class="p">:</span> <span class="s">"presto"</span>
  <span class="nt">affinity</span><span class="p">:</span>
    <span class="nt">podAffinity</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</td>
<td><p>Specifies the worker pod’s node selector and affinity.</p></td>
</tr>
<tr class="row-odd"><td><p>additionalProperties</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">worker</span><span class="p">:</span>
  <span class="nt">additionalProperties</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">resource-groups.config-file=filename</span>
</pre></div>
</div>
</td>
<td><p>Specify additional <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">configuration properties</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>additionalAnnotations</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>


<span id="k8s-probes"></span><h2 id="readiness-and-liveness-probe">Readiness and Liveness Probe<a class="headerlink" href="#readiness-and-liveness-probe" title="Permalink to this headline">#</a></h2>
<p>You can configure <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/">Kubernetes probes</a>
with the <code class="docutils literal notranslate"><span class="pre">readinessProbe</span></code> and <code class="docutils literal notranslate"><span class="pre">livenessProbe</span></code> elements.</p>
<table id="id5">
<caption><span class="caption-text">Readiness and liveness probe properties</span><a class="headerlink" href="#id5" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>readinessProbe</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">readinessProbe</span><span class="p">:</span>
  <span class="nt">initialDelaySeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
  <span class="nt">periodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
  <span class="nt">timeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
</pre></div>
</div>
</td>
<td><p>Properties of the coordinator and worker readiness probes. For more
information on readiness probes, refer to <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/">Kubernetes probes</a>.</p></td>
</tr>
<tr class="row-odd"><td><p>livenessProbe</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">livenessProbe</span><span class="p">:</span>
  <span class="nt">initialDelaySeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
  <span class="nt">periodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
  <span class="nt">failureThreshold</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">timeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
</pre></div>
</div>
</td>
<td><p>Properties of coordinator and worker liveness probes. For more
information on liveness probes, refer to <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/">Kubernetes probes</a>.</p></td>
</tr>
</tbody>
</table>


<span id="k8s-usage-metrics"></span><h2 id="usage-metrics">Usage Metrics<a class="headerlink" href="#usage-metrics" title="Permalink to this headline">#</a></h2>
<p>The defaults configure <a class="reference internal" href="../admin/usage-metrics.html"><span class="doc">usage metrics</span></a> correctly.
No changes are necessary.</p>


<h2 id="spill-to-disk-properties">Spill to Disk Properties<a class="headerlink" href="#spill-to-disk-properties" title="Permalink to this headline">#</a></h2>
<p>You can add an additional volume and enable the optional <a class="reference internal" href="../admin/spill.html"><span class="doc">disk spilling</span></a> in the <code class="docutils literal notranslate"><span class="pre">spilling</span></code> section. Use <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/#types-of-volumes">any type of volume supported
by k8s</a>,
and configure it in <code class="docutils literal notranslate"><span class="pre">spec.volumes</span></code>.</p>
<p>The volume needs to be defined, and then used for spilling:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span>
  <span class="nt">volumes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">someVolume</span>
    <span class="nt">emptyDir</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mySpillVolume</span>
    <span class="nt">hostPath</span><span class="p">:</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/opt/data</span>
      <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Directory</span>

<span class="nt">spilling</span><span class="p">:</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">volume</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">mySpillVolume</span>
</pre></div>
</div>
<p>The default spilling configuration uses <code class="docutils literal notranslate"><span class="pre">spec.volumes[0]</span></code> set to <code class="docutils literal notranslate"><span class="pre">emptyDir</span></code>.
We recommend using <code class="docutils literal notranslate"><span class="pre">emptyDir</span></code> or <code class="docutils literal notranslate"><span class="pre">hostPath</span></code> type for spilling. Ensure that
each worker has exclusive access to its spilling volume, and the path
exists.</p>


<h2 id="hive-connector-properties">Hive Connector Properties<a class="headerlink" href="#hive-connector-properties" title="Permalink to this headline">#</a></h2>
<p>SEP on Kubernetes provides automatic configuration of the Hive connector. Such a
connector allows you to either access an external Metastore or use built-in
internal Presto cluster Metastore as well.</p>

<h3 id="external-metastore">External Metastore<a class="headerlink" href="#external-metastore" title="Permalink to this headline">#</a></h3>
<p>You can configure Presto to use an external Hive Metastore by setting the
<code class="code docutils literal notranslate"><span class="pre">hive.metastoreUri</span></code> property, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">metastoreUri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">thrift://hive-metastore:9083</span>
</pre></div>
</div>
<table id="id6">
<caption><span class="caption-text">External metastore properties</span><a class="headerlink" href="#id6" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>awsSecretName</p></td>
<td></td>
<td><p>Name of the AWS secret to access the metastore</p></td>
</tr>
<tr class="row-odd"><td><p>googleServiceAccountKeySecretName</p></td>
<td></td>
<td><p>Name of the secret key for the Google service account to access the
metastore</p></td>
</tr>
<tr class="row-even"><td><p>azureWasbSecretName</p></td>
<td></td>
<td><p>Name of the secret for the Windows Azure Storage Blob (WASB) to access the
metastore</p></td>
</tr>
<tr class="row-odd"><td><p>azureAbfsSecretName</p></td>
<td></td>
<td><p>Name of the secret for the Azure Blob Filesystem (ABFS) to access the
metastore</p></td>
</tr>
<tr class="row-even"><td><p>azureAdlSecretName</p></td>
<td></td>
<td><p>Name of the secret for the Azure Data Lake (ADL) to access the metastore</p></td>
</tr>
<tr class="row-odd"><td><p>additionalProperties</p></td>
<td><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">additionalProperties</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">hive.allow-drop-table=true</span>
</pre></div>
</div>
</td>
<td><p>Specify additional properties to configure the Hive connector behavior.</p></td>
</tr>
</tbody>
</table>


<h3 id="internal-metastore">Internal Metastore<a class="headerlink" href="#internal-metastore" title="Permalink to this headline">#</a></h3>
<p>You can configure Presto to use an internal Hive Metastore by setting the
<code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.mySql</span></code> or
<code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.postgreSql</span></code> properties, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">internalMetastore</span><span class="p">:</span>
    <span class="nt">mySql</span><span class="p">:</span>
      <span class="nt">jdbcUrl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jdbc:mysql://mysql-server/metastore-database</span>
      <span class="nt">username</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hive</span>
      <span class="nt">password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hivePassword</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">internalMetastore</span><span class="p">:</span>
    <span class="nt">postgreSql</span><span class="p">:</span>
      <span class="nt">jdbcUrl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jdbc:postgresql://postgresql-server/metastore-database</span>
      <span class="nt">username</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hive</span>
      <span class="nt">password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hivePassword</span>
</pre></div>
</div>
<p>In such a case, an additional Hive Metastore pod is created. It stores the
metadata in the provided PostgreSQL or MySQL database.</p>
<p>You can also make the internal Metastore to use an internal ephemeral PostgreSQL
database. This can be enabled by setting the
<code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.enabled</span></code> to <code class="code docutils literal notranslate"><span class="pre">true</span></code>, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">internalMetastore</span><span class="p">:</span>
    <span class="nt">internalPostgreSql</span><span class="p">:</span>
      <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>In this case, an additional PostgreSQL pod is created along with the Hive
Metastore pod. This Hive Metastore uses the internal ephemeral PostgreSQL as a
relational database.</p>
<p><strong>Note:</strong> Using the internal ephemeral PostgreSQL is not recommended for
production. Data stored within the internal PostgreSQL is lost when the Presto
cluster is terminated.</p>
<p><strong>Note:</strong> You cannot use external and internal Metastore at the same time. You
also cannot use external and internal relational database for Metastore at the
same time.</p>


<h3 id="customizing-internal-hive-metastore-pod">Customizing Internal Hive Metastore Pod<a class="headerlink" href="#customizing-internal-hive-metastore-pod" title="Permalink to this headline">#</a></h3>
<p>It possible to customize internal Hive Metastore pod’s Docker image via the
<code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.image</span></code> property, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">internalMetastore</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">customized-internal-hive-metastore:0.1</span>
      <span class="nt">pullPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
</pre></div>
</div>
<p>It is possible to change the resources required by Hive Metastore’s pod via:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.cpu</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.memory</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.nodeSelector</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.affinity</span></code></p></li>
</ul>
</div></blockquote>
<p>properties.</p>


<span id="internal-postgresql"></span><h3 id="customizing-internal-postgresql-docker-pod">Customizing Internal PostgreSQL Docker Pod<a class="headerlink" href="#customizing-internal-postgresql-docker-pod" title="Permalink to this headline">#</a></h3>
<p>It is possible to customize the internal PostgreSQL pod’s Docker image via the
<code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.image</span></code> property, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">internalMetastore</span><span class="p">:</span>
    <span class="nt">internalPostgreSql</span><span class="p">:</span>
      <span class="nt">image</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">customized-internal-postgresql:0.1</span>
        <span class="nt">pullPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
</pre></div>
</div>
<p>It is possible to change the resources required by PostgreSQL’s pod via:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.cpu</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.memory</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.nodeSelector</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.affinity</span></code></p></li>
</ul>
</div></blockquote>
<p>properties.</p>
<p>It is possible to specify the storage used by PostgreSQL’s pod via: the
<code class="code docutils literal notranslate"><span class="pre">hive.internalMetastore.internalPostgreSql.storage</span></code> property, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hive</span><span class="p">:</span>
  <span class="nt">internalMetastore</span><span class="p">:</span>
    <span class="nt">internalPostgreSql</span><span class="p">:</span>
      <span class="nt">storage</span><span class="p">:</span>
        <span class="nt">className</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">db-class</span>
        <span class="nt">size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20Gi</span>
        <span class="nt">claimSelector</span><span class="p">:</span>
          <span class="nt">matchLabels</span><span class="p">:</span>
            <span class="nt">release</span><span class="p">:</span> <span class="s">"stable"</span>
          <span class="nt">matchExpressions</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span><span class="nt">key</span><span class="p">:</span> <span class="nv">environment</span><span class="p p-Indicator">,</span><span class="nt"> operator</span><span class="p">:</span> <span class="nv">In</span><span class="p p-Indicator">,</span><span class="nt"> values</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">dev</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>



<h2 id="prometheus-support">Prometheus Support<a class="headerlink" href="#prometheus-support" title="Permalink to this headline">#</a></h2>
<p>Presto Kubernetes supports exposing Presto metrics to Prometheus. You can use
the <a class="reference external" href="https://github.com/coreos/prometheus-operator">Prometheus Operator</a> in
order to set up Prometheus in your Kubernetes cluster and collect Presto
metrics.</p>
<p>To enable Presto Prometheus metric endpoints set the <code class="code docutils literal notranslate"><span class="pre">prometheus.enabled</span></code>
property to <code class="code docutils literal notranslate"><span class="pre">true</span></code>. This causes the following additional Kubernetes
services to be created:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">prometheus-coordinator-CLUSTER_NAME_UUID</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">prometheus-worker-CLUSTER_NAME_UUID</span></code></p></li>
</ul>
<p>where <code class="code docutils literal notranslate"><span class="pre">CLUSTER_NAME_UUID</span></code> is the cluster name with a unique suffix. Use
the <code class="code docutils literal notranslate"><span class="pre">nameOverride</span></code> property in order to set <code class="code docutils literal notranslate"><span class="pre">CLUSTER_NAME_UUID</span></code> to a
different value.</p>
<p>Those services expose Presto metrics in the Prometheus format. You can use
<a class="reference external" href="https://github.com/coreos/prometheus-operator#customresourcedefinitions">ServiceMonitor</a>
resources from the Prometheus Operator to make Prometheus collect metrics from
those endpoints. In order to match Presto Prometheus endpoints you can use
<a class="reference internal" href="overview.html#labels"><span class="std std-ref">labels</span></a>, e.g.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">matchLabels</span><span class="p">:</span>
  <span class="nt">instance</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CLUSTER_NAME_UUID</span>
  <span class="nt">role</span><span class="p">:</span> <span class="s">"prometheus-coordinator"</span>
</pre></div>
</div>
<p>The following Presto and JVM metrics are exported by default:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">running_queries</span></code> - number of currently running queries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">queued_queries</span></code> - number of currently queued queries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failed_queries</span></code> - total count of failed queries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jvm_gc_collection_seconds_sum</span></code> - total GC (young and old) time in seconds</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jvm_gc_collection_seconds_count</span></code> - total GC (young and old) count</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jvm_memory_bytes_committed,</span> <span class="pre">jvm_memory_bytes_init,</span> <span class="pre">jvm_memory_bytes_max,</span>
<span class="pre">jvm_memory_bytes_used</span></code> - JVM memory usage metrics (heap and non-heap). For
more information see <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/management/MemoryMXBean.html">MemoryMXBean</a>.</p></li>
</ul>




          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="deployment.html" title="Deployment of Presto on Kubernetes"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Deployment of Presto on Kubernetes </span>
              </div>
            </a>
          
          
            <a href="query.html" title="Querying Presto"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Querying Presto </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #000A2C; align-content: center; height: 5em;">

</div>
  </body>
</html>